var test={};(function(c,a){var d=wp.media;var b=d.view.Attachment.Details.TwoColumn;d.view.Attachment.Details.TwoColumn=b.extend({events:function(){return a.extend({},b.prototype.events,{"click .local-warning":"confirmS3Removal","click #as3cfpro-toggle-acl":"toggleACL"})},render:function(){this.fetchS3Details(this.model.get("id"))},fetchS3Details:function(e){wp.ajax.send("as3cf_get_attachment_s3_details",{data:{_nonce:as3cf_media.nonces.get_attachment_s3_details,id:e}}).done(a.bind(this.renderView,this))},renderView:function(e){b.prototype.render.apply(this);this.renderActionLinks(e);this.renderS3Details(e)},renderActionLinks:function(f){var e=(f&&f.links)||[];var i=this.$el.find(".actions");var g=c("<div />",{"class":"s3-actions"});var h=[];a(e).each(function(j){h.push(j)});g.append(h.join(" | "));i.append(g)},renderS3Details:function(e){if(!e||!e.s3object){return}var g=this.$el.find(".attachment-info .details");var f=this.generateDetails(e,["bucket","key","region","acl"]);g.append(f)},generateDetails:function(e,h){var f="";var g=a.template('<div class="<%= key %>"><strong><%= label %>:</strong> <%= value %></div>');a(h).each(function(i){if(e.s3object[i]){var j=e.s3object[i];if("acl"===i){j=e.s3object[i]["name"];if(e.acl_toggle){var k=a.template('<a href="#" id="as3cfpro-toggle-acl" title="<%= title %>" data-currentACL="<%= acl %>"><%= value %></a>');j=k({title:e.s3object[i]["title"],acl:e.s3object[i]["acl"],value:j})}}f+=g({key:i,label:as3cf_media.strings[i],value:j})}});return f},confirmS3Removal:function(e){if(!confirm(as3cfpro_media.strings.local_warning)){e.preventDefault();e.stopImmediatePropagation();return false}},toggleACL:function(h){h.preventDefault();var e=c("#as3cfpro-toggle-acl");var g=e.attr("data-currentACL");var f=as3cfpro_media.settings.private_acl;e.hide();e.after('<span id="as3cfpro-updating">'+as3cfpro_media.strings.updating_acl+"</span>");if(g===as3cfpro_media.settings.private_acl){f=as3cfpro_media.settings.default_acl}wp.ajax.send("as3cfpro_update_acl",{data:{_nonce:as3cfpro_media.nonces.update_acl,id:this.model.get("id"),acl:f}}).done(a.bind(this.updateACL,this)).fail(a.bind(this.renderACLError,this))},renderACLError:function(){c("#as3cfpro-updating").remove();c("#as3cfpro-toggle-acl").show();alert(as3cfpro_media.strings.change_acl_error)},updateACL:function(f){if("undefined"===typeof f.acl_display||"undefined"===typeof f.title||"undefined"===typeof f.acl){this.renderACLError();return}var e=c("#as3cfpro-toggle-acl");c("#as3cfpro-updating").remove();e.text(f.acl_display);e.attr("title",f.title);e.attr("data-currentACL",f.acl);e.show()}})})(jQuery,_);