!function(a){"use strict";if(window.wilokeAdmin={},a().wilokeColorPicker||(a.fn.wilokeColorPicker=function(){var b=!1;if(null!==WilokeAdminGlobal.ColorPalatte){var c;c="object"==typeof WilokeAdminGlobal.ColorPalatte?WilokeAdminGlobal.ColorPalatte:a.parseJSON(WilokeAdminGlobal.ColorPalatte)}else c=null;a(this).spectrum({preferredFormat:"rgb",showAlpha:!0,change:function(b){null!==b?a(this).attr("value",b.toRgbString()):a(this).attr("value","")},move:function(b){a(this).next().find(".sp-preview-inner").data("color",b.toRgbString()).change()},hide:function(){a(this).change()},allowEmpty:!0,showInput:!0,showPalette:b,palette:c})}),"undefined"!=typeof vc&&"undefined"!=typeof vc.shortcode_view){var b=vc.shortcodes;window.WilokeTabView=vc.shortcode_view.extend({new_tab_adding:!1,events:{"click .add_tab":"addTab","click > .vc_controls .vc_control-btn-delete":"deleteShortcode","click > .vc_controls .vc_control-btn-edit":"editElement","click > .vc_controls .vc_control-btn-clone":"clone"},initialize:function(a){window.WilokeTabView.__super__.initialize.call(this,a),_.bindAll(this,"stopSorting")},render:function(){return window.WilokeTabView.__super__.render.call(this),this.$tabs=this.$el.find(".wpb_tabs_holder"),this.createAddTabButton(),this},ready:function(a){return window.WilokeTabView.__super__.ready.call(this,a),this},createAddTabButton:function(){var b=+new Date+"-"+Math.floor(11*Math.random());this.$tabs.append('<div id="new-tab-'+b+'" class="new_element_button"></div>'),this.$add_button=a('<li class="add_tab_block"><a href="#new-tab-'+b+'" class="add_tab" title="'+window.i18nLocale.add_tab+'"></a></li>').appendTo(this.$tabs.find(".tabs_controls"))},addTab:function(a){a.preventDefault(),this.new_tab_adding=!0;var b=window.i18nLocale.tab,c=this.$tabs.find("[data-element_type=single_tab]").length,d=+new Date+"-"+c+"-"+Math.floor(11*Math.random());return vc.shortcodes.create({shortcode:"single_tab",params:{title:b,tab_id:d},parent_id:this.model.id}),!1},stopSorting:function(b,c){var d;this.$tabs.find("ul.tabs_controls li:not(.add_tab_block)").each(function(b){a(this).find("a").attr("href").replace("#","");d=vc.shortcodes.get(a("[id="+a(this).attr("aria-controls")+"]").data("model-id")),vc.storage.lock(),d.save({order:a(this).index()})}),d.save()},changedContent:function(b){var c=b.model.get("params");if(this.$tabs.hasClass("ui-tabs")||(this.$tabs.tabs({select:function(b,c){return!a(c.tab).hasClass("add_tab")}}),this.$tabs.find(".ui-tabs-nav").prependTo(this.$tabs),this.$tabs.find(".ui-tabs-nav").sortable({axis:"test_element"==this.$tabs.closest("[data-element_type]").data("element_type")?"y":"x",update:this.stopSorting,items:"> li:not(.add_tab_block)"})),b.model.get("cloned")===!0){var e=(b.model.get("cloned_from"),a(".tabs_controls > .add_tab_block",this.$content)),f=a("<li><a href='#tab-"+c.tab_id+"'>"+c.title+"</a></li>").insertBefore(e);this.$tabs.tabs("refresh"),this.$tabs.tabs("option","active",f.index())}else a("<li><a href='#tab-"+c.tab_id+"'>"+c.title+"</a></li>").insertBefore(this.$add_button),this.$tabs.tabs("refresh"),this.$tabs.tabs("option","active",this.new_tab_adding?a(".ui-tabs-nav li",this.$content).length-2:0);this.new_tab_adding=!1},cloneModel:function(a,c,d){var g,f=_.isBoolean(d)&&d===!0?a.get("order"):parseFloat(a.get("order"))+vc.clone_index,h=_.extend({},a.get("params"));return"single_tab"===a.get("shortcode")&&_.extend(h,{tab_id:+new Date+"-"+this.$tabs.find("[data-element-type=single_tab]").length+"-"+Math.floor(11*Math.random())}),g=b.create({shortcode:a.get("shortcode"),id:vc_guid(),parent_id:c,order:f,cloned:"single_tab"!==a.get("shortcode"),cloned_from:a.toJSON(),params:h}),_.each(b.where({parent_id:a.id}),function(a){this.cloneModel(a,g.get("id"),!0)},this),g}})}a(document).ready(function(){a(".wiloke-colorpicker").each(function(){a(this).wilokeColorPicker()}),a(".wiloke-sortable").length>0&&a(".wiloke-sortable").sortable(),a("#is_show_content").change(function(){"yes"==a(this).val()&&"template/template-portfolio3.php"==a("#page_template").val()?(a(".cmb_id_is_block_background").show(),"yes"==a("#is_block_background").val()&&a(".cmb_id_block_background, .cmb_id_first_block_content, .cmb_id_first_block_title, .cmb_id_block_background_color, .cmb_id_block_background_position, .cmb_id_block_background_repeat, .cmb_id_block_background_attachment").show()):a(".cmb_id_is_block_background, .cmb_id_first_block_content, .cmb_id_first_block_title,.cmb_id_block_background_color, .cmb_id_block_background, .cmb_id_block_background_position, .cmb_id_block_background_repeat, .cmb_id_block_background_attachment").hide()}).trigger("change"),a("#sidebarinfo_repeat").length>0&&a("#sidebarinfo_repeat").wilokePostFormatMediaPopup({return:"url",multiple:!1,isPreview:!1,buttonClass:".wiloke-button"}),a("#page_template").change(function(){"template/page-builder.php"==a(this).val()?(a("#wiloke_page_builder").show(),a("#postdivrich").addClass("hidden")):(a("#wiloke_page_builder").hide(),a("#postdivrich").removeClass("hidden"),a("#wiloke-save-custom-content, #wiloke-save-custom-content").addClass("hidden"),a(window).trigger("resize"))}).trigger("change"),a(document).on("click","#wiloke-vc-listofterms-toggle-select",function(b){b.preventDefault(),a(this).prev().find("option:selected").length?a(this).prev().find("option:selected").each(function(){a(this).prop("selected",!1)}):a(this).prev().find("option").each(function(){a(this).prop("selected",!0)})})})}(jQuery);