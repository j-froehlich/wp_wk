jQuery(function(c){var a={init:function(){c("#variable_product_options").on("change","input.variable_is_downloadable",this.variable_is_downloadable).on("change","input.variable_is_virtual",this.variable_is_virtual).on("change","input.variable_manage_stock",this.variable_manage_stock).on("click","button.notice-dismiss",this.notice_dismiss).on("click","h3 .sort",this.set_menu_order).on("reload",this.reload);c("input.variable_is_downloadable, input.variable_is_virtual, input.variable_manage_stock").change();c("#woocommerce-product-data").on("woocommerce_variations_loaded",this.variations_loaded);c(document.body).on("woocommerce_variations_added",this.variation_added)},reload:function(){b.load_variations(1);e.set_paginav(0)},variable_is_downloadable:function(){c(this).closest(".woocommerce_variation").find(".show_if_variation_downloadable").hide();if(c(this).is(":checked")){c(this).closest(".woocommerce_variation").find(".show_if_variation_downloadable").show()}},variable_is_virtual:function(){c(this).closest(".woocommerce_variation").find(".hide_if_variation_virtual").show();if(c(this).is(":checked")){c(this).closest(".woocommerce_variation").find(".hide_if_variation_virtual").hide()}},variable_manage_stock:function(){c(this).closest(".woocommerce_variation").find(".show_if_variation_manage_stock").hide();if(c(this).is(":checked")){c(this).closest(".woocommerce_variation").find(".show_if_variation_manage_stock").show()}},notice_dismiss:function(){c(this).closest("div.notice").remove()},variations_loaded:function(g,f){f=f||false;var h=c("#woocommerce-product-data");if(!f){c("input.variable_is_downloadable, input.variable_is_virtual, input.variable_manage_stock",h).change();c(".woocommerce_variation",h).each(function(j,l){var k=c(l),m=c(".sale_price_dates_from",k).val(),i=c(".sale_price_dates_to",k).val();if(""!==m||""!==i){c("a.sale_schedule",k).click()}});c(".woocommerce_variations .variation-needs-update",h).removeClass("variation-needs-update");c("button.cancel-variation-changes, button.save-variation-changes",h).attr("disabled","disabled")}c("#tiptip_holder").removeAttr("style");c("#tiptip_arrow").removeAttr("style");c(".woocommerce_variations .tips, .woocommerce_variations .help_tip, .woocommerce_variations .woocommerce-help-tip",h).tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200});c(".sale_price_dates_fields",h).find("input").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:true,onSelect:function(){var j=c(this).is(".sale_price_dates_from")?"minDate":"maxDate",k=c(this).closest(".sale_price_dates_fields").find("input"),i=c(this).datepicker("getDate");k.not(this).datepicker("option",j,i);c(this).change()}});c(".woocommerce_variations",h).sortable({items:".woocommerce_variation",cursor:"move",axis:"y",handle:".sort",scrollSensitivity:40,forcePlaceholderSize:true,helper:"clone",opacity:0.65,stop:function(){a.variation_row_indexes()}});c(document.body).trigger("wc-enhanced-select-init")},variation_added:function(f,g){if(1===g){a.variations_loaded(null,true)}},set_menu_order:function(g){g.preventDefault();var f=c(this).closest(".woocommerce_variation").find(".variation_menu_order");var h=window.prompt(woocommerce_admin_meta_boxes_variations.i18n_enter_menu_order,f.val());if(h!=null){f.val(parseInt(h,10)).change();b.save_variations()}},variation_row_indexes:function(){var h=c("#variable_product_options").find(".woocommerce_variations"),f=parseInt(h.attr("data-page"),10),g=parseInt((f-1)*woocommerce_admin_meta_boxes_variations.variations_per_page,10);c(".woocommerce_variations .woocommerce_variation").each(function(i,j){c(".variation_menu_order",j).val(parseInt(c(j).index(".woocommerce_variations .woocommerce_variation"),10)+1+g).change()})}};var d={variable_image_frame:null,setting_variation_image_id:null,setting_variation_image:null,wp_media_post_id:wp.media.model.settings.post.id,init:function(){c("#variable_product_options").on("click",".upload_image_button",this.add_image);c("a.add_media").on("click",this.restore_wp_media_post_id)},add_image:function(g){var h=c(this),f=h.attr("rel"),i=h.closest(".upload_image");d.setting_variation_image=i;d.setting_variation_image_id=f;g.preventDefault();if(h.is(".remove")){c(".upload_image_id",d.setting_variation_image).val("").change();d.setting_variation_image.find("img").eq(0).attr("src",woocommerce_admin_meta_boxes_variations.woocommerce_placeholder_img_src);d.setting_variation_image.find(".upload_image_button").removeClass("remove")}else{if(d.variable_image_frame){d.variable_image_frame.uploader.uploader.param("post_id",d.setting_variation_image_id);d.variable_image_frame.open();return}else{wp.media.model.settings.post.id=d.setting_variation_image_id}d.variable_image_frame=wp.media.frames.variable_image=wp.media({title:woocommerce_admin_meta_boxes_variations.i18n_choose_image,button:{text:woocommerce_admin_meta_boxes_variations.i18n_set_image},states:[new wp.media.controller.Library({title:woocommerce_admin_meta_boxes_variations.i18n_choose_image,filterable:"all"})]});d.variable_image_frame.on("select",function(){var k=d.variable_image_frame.state().get("selection").first().toJSON(),j=k.sizes&&k.sizes.thumbnail?k.sizes.thumbnail.url:k.url;c(".upload_image_id",d.setting_variation_image).val(k.id).change();d.setting_variation_image.find(".upload_image_button").addClass("remove");d.setting_variation_image.find("img").eq(0).attr("src",j);wp.media.model.settings.post.id=d.wp_media_post_id});d.variable_image_frame.open()}},restore_wp_media_post_id:function(){wp.media.model.settings.post.id=d.wp_media_post_id}};var b={init:function(){c("li.variations_tab a").on("click",this.initial_load);c("#variable_product_options").on("click","button.save-variation-changes",this.save_variations).on("click","button.cancel-variation-changes",this.cancel_variations).on("click",".remove_variation",this.remove_variation);c(document.body).on("change","#variable_product_options .woocommerce_variations :input",this.input_changed).on("change",".variations-defaults select",this.defaults_changed);c("form#post").on("submit",this.save_on_submit);c(".wc-metaboxes-wrapper").on("click","a.do_variation_action",this.do_variation_action)},check_for_changes:function(){var f=c("#variable_product_options").find(".woocommerce_variations .variation-needs-update");if(0<f.length){if(window.confirm(woocommerce_admin_meta_boxes_variations.i18n_edited_variations)){b.save_changes()}else{f.removeClass("variation-needs-update");return false}}return true},block:function(){c("#woocommerce-product-data").block({message:null,overlayCSS:{background:"#fff",opacity:0.6}})},unblock:function(){c("#woocommerce-product-data").unblock()},initial_load:function(){if(0===c("#variable_product_options").find(".woocommerce_variations .woocommerce_variation").length){e.go_to_page()}},load_variations:function(g,f){g=g||1;f=f||woocommerce_admin_meta_boxes_variations.variations_per_page;var h=c("#variable_product_options").find(".woocommerce_variations");b.block();c.ajax({url:woocommerce_admin_meta_boxes_variations.ajax_url,data:{action:"woocommerce_load_variations",security:woocommerce_admin_meta_boxes_variations.load_variations_nonce,product_id:woocommerce_admin_meta_boxes_variations.post_id,attributes:h.data("attributes"),page:g,per_page:f},type:"POST",success:function(i){h.empty().append(i).attr("data-page",g);c("#woocommerce-product-data").trigger("woocommerce_variations_loaded");b.unblock()}})},get_variations_fields:function(f){var g=c(":input",f).serializeJSON();c(".variations-defaults select").each(function(i,j){var h=c(j);g[h.attr("name")]=h.val()});return g},save_changes:function(i){var h=c("#variable_product_options").find(".woocommerce_variations"),f=c(".variation-needs-update",h),g={};if(0<f.length){b.block();g=b.get_variations_fields(f);g.action="woocommerce_save_variations";g.security=woocommerce_admin_meta_boxes_variations.save_variations_nonce;g.product_id=woocommerce_admin_meta_boxes_variations.post_id;g["product-type"]=c("#product-type").val();c.ajax({url:woocommerce_admin_meta_boxes_variations.ajax_url,data:g,type:"POST",success:function(j){f.removeClass("variation-needs-update");c("button.cancel-variation-changes, button.save-variation-changes").attr("disabled","disabled");c("#woocommerce-product-data").trigger("woocommerce_variations_saved");if(typeof i==="function"){i(j)}b.unblock()}})}},save_variations:function(){c("#variable_product_options").trigger("woocommerce_variations_save_variations_button");b.save_changes(function(f){var h=c("#variable_product_options").find(".woocommerce_variations"),g=h.attr("data-page");c("#variable_product_options").find("#woocommerce_errors").remove();if(f){h.before(f)}c(".variations-defaults select").each(function(){c(this).attr("data-current",c(this).val())});e.go_to_page(g)});return false},save_on_submit:function(g){var f=c("#variable_product_options").find(".woocommerce_variations .variation-needs-update");if(0<f.length){g.preventDefault();c("#variable_product_options").trigger("woocommerce_variations_save_variations_on_submit");b.save_changes(b.save_on_submit_done)}},save_on_submit_done:function(){c("form#post").submit()},cancel_variations:function(){var f=parseInt(c("#variable_product_options").find(".woocommerce_variations").attr("data-page"),10);c("#variable_product_options").find(".woocommerce_variations .variation-needs-update").removeClass("variation-needs-update");c(".variations-defaults select").each(function(){c(this).val(c(this).attr("data-current"))});e.go_to_page(f);return false},add_variation:function(){b.block();var f={action:"woocommerce_add_variation",post_id:woocommerce_admin_meta_boxes_variations.post_id,loop:c(".woocommerce_variation").length,security:woocommerce_admin_meta_boxes_variations.add_variation_nonce};c.post(woocommerce_admin_meta_boxes_variations.ajax_url,f,function(g){var h=c(g);h.addClass("variation-needs-update");c("#variable_product_options").find(".woocommerce_variations").prepend(h);c("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled");c("#variable_product_options").trigger("woocommerce_variations_added",1);b.unblock()});return false},remove_variation:function(){b.check_for_changes();if(window.confirm(woocommerce_admin_meta_boxes_variations.i18n_remove_variation)){var f=c(this).attr("rel"),g=[],h={action:"woocommerce_remove_variations"};b.block();if(0<f){g.push(f);h.variation_ids=g;h.security=woocommerce_admin_meta_boxes_variations.delete_variations_nonce;c.post(woocommerce_admin_meta_boxes_variations.ajax_url,h,function(){var l=c("#variable_product_options").find(".woocommerce_variations"),k=parseInt(l.attr("data-page"),10),i=Math.ceil((parseInt(l.attr("data-total"),10)-1)/woocommerce_admin_meta_boxes_variations.variations_per_page),j=1;c("#woocommerce-product-data").trigger("woocommerce_variations_removed");if(k===i||k<=i){j=k}else{if(k>i&&0!==i){j=i}}e.go_to_page(j,-1)})}else{b.unblock()}}return false},link_all_variations:function(){b.check_for_changes();if(window.confirm(woocommerce_admin_meta_boxes_variations.i18n_link_all_variations)){b.block();var f={action:"woocommerce_link_all_variations",post_id:woocommerce_admin_meta_boxes_variations.post_id,security:woocommerce_admin_meta_boxes_variations.link_variation_nonce};c.post(woocommerce_admin_meta_boxes_variations.ajax_url,f,function(g){var h=parseInt(g,10);if(1===h){window.alert(h+" "+woocommerce_admin_meta_boxes_variations.i18n_variation_added)}else{if(0===h||h>1){window.alert(h+" "+woocommerce_admin_meta_boxes_variations.i18n_variations_added)}else{window.alert(woocommerce_admin_meta_boxes_variations.i18n_no_variations_added)}}if(h>0){e.go_to_page(1,h);c("#variable_product_options").trigger("woocommerce_variations_added",h)}else{b.unblock()}})}return false},input_changed:function(){c(this).closest(".woocommerce_variation").addClass("variation-needs-update");c("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled");c("#variable_product_options").trigger("woocommerce_variations_input_changed")},defaults_changed:function(){c(this).closest("#variable_product_options").find(".woocommerce_variation:first").addClass("variation-needs-update");c("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled");c("#variable_product_options").trigger("woocommerce_variations_defaults_changed")},do_variation_action:function(){var f=c("select.variation_actions").val(),i={},g=0,h;switch(f){case"add_variation":b.add_variation();return;case"link_all_variations":b.link_all_variations();return;case"delete_all":if(window.confirm(woocommerce_admin_meta_boxes_variations.i18n_delete_all_variations)){if(window.confirm(woocommerce_admin_meta_boxes_variations.i18n_last_warning)){i.allowed=true;g=parseInt(c("#variable_product_options").find(".woocommerce_variations").attr("data-total"),10)*-1}}break;case"variable_regular_price_increase":case"variable_regular_price_decrease":case"variable_sale_price_increase":case"variable_sale_price_decrease":h=window.prompt(woocommerce_admin_meta_boxes_variations.i18n_enter_a_value_fixed_or_percent);if(h!=null){if(h.indexOf("%")>=0){i.value=accounting.unformat(h.replace(/\%/,""),woocommerce_admin.mon_decimal_point)+"%"}else{i.value=accounting.unformat(h,woocommerce_admin.mon_decimal_point)}}else{return}break;case"variable_regular_price":case"variable_sale_price":case"variable_stock":case"variable_weight":case"variable_length":case"variable_width":case"variable_height":case"variable_download_limit":case"variable_download_expiry":h=window.prompt(woocommerce_admin_meta_boxes_variations.i18n_enter_a_value);if(h!=null){i.value=h}else{return}break;case"variable_sale_schedule":i.date_from=window.prompt(woocommerce_admin_meta_boxes_variations.i18n_scheduled_sale_start);i.date_to=window.prompt(woocommerce_admin_meta_boxes_variations.i18n_scheduled_sale_end);if(null===i.date_from){i.date_from=false}if(null===i.date_to){i.date_to=false}if(false===i.date_to&&false===i.date_from){return}break;default:c("select.variation_actions").trigger(f);i=c("select.variation_actions").triggerHandler(f+"_ajax_data",i);break}if("delete_all"===f&&i.allowed){c("#variable_product_options").find(".variation-needs-update").removeClass("variation-needs-update")}else{b.check_for_changes()}b.block();c.ajax({url:woocommerce_admin_meta_boxes_variations.ajax_url,data:{action:"woocommerce_bulk_edit_variations",security:woocommerce_admin_meta_boxes_variations.bulk_edit_variations_nonce,product_id:woocommerce_admin_meta_boxes_variations.post_id,product_type:c("#product-type").val(),bulk_action:f,data:i},type:"POST",success:function(){e.go_to_page(1,g)}})}};var e={init:function(){c(document.body).on("woocommerce_variations_added",this.update_single_quantity).on("change",".variations-pagenav .page-selector",this.page_selector).on("click",".variations-pagenav .first-page",this.first_page).on("click",".variations-pagenav .prev-page",this.prev_page).on("click",".variations-pagenav .next-page",this.next_page).on("click",".variations-pagenav .last-page",this.last_page)},update_variations_count:function(i){var h=c("#variable_product_options").find(".woocommerce_variations"),g=parseInt(h.attr("data-total"),10)+i,f=c(".variations-pagenav .displaying-num");h.attr("data-total",g);if(1===g){f.text(woocommerce_admin_meta_boxes_variations.i18n_variation_count_single.replace("%qty%",g))}else{f.text(woocommerce_admin_meta_boxes_variations.i18n_variation_count_plural.replace("%qty%",g))}return g},update_single_quantity:function(f,h){if(1===h){var g=c(".variations-pagenav");e.update_variations_count(h);if(g.is(":hidden")){c("option, optgroup",".variation_actions").show();c(".variation_actions").val("add_variation");c("#variable_product_options").find(".toolbar").show();g.show();c(".pagination-links",g).hide()}}},set_paginav:function(o){var f=c("#variable_product_options").find(".woocommerce_variations"),j=e.update_variations_count(o),m=c("#variable_product_options").find(".toolbar"),g=c(".variation_actions"),l=c(".variations-pagenav"),h=c(".pagination-links",l),n=Math.ceil(j/woocommerce_admin_meta_boxes_variations.variations_per_page),p="";f.attr("data-total_pages",n);c(".total-pages",l).text(n);for(var k=1;k<=n;k++){p+='<option value="'+k+'">'+k+"</option>"}c(".page-selector",l).empty().html(p);if(0===j){m.not(".toolbar-top, .toolbar-buttons").hide();l.hide();c("option, optgroup",g).hide();c(".variation_actions").val("add_variation");c('option[data-global="true"]',g).show()}else{m.show();l.show();c("option, optgroup",g).show();c(".variation_actions").val("add_variation");if(1===n){h.hide()}else{h.show()}}},check_is_enabled:function(f){return !c(f).hasClass("disabled")},change_classes:function(g,i){var k=c(".variations-pagenav .first-page"),f=c(".variations-pagenav .prev-page"),j=c(".variations-pagenav .next-page"),h=c(".variations-pagenav .last-page");if(1===g){k.addClass("disabled");f.addClass("disabled")}else{k.removeClass("disabled");f.removeClass("disabled")}if(i===g){j.addClass("disabled");h.addClass("disabled")}else{j.removeClass("disabled");h.removeClass("disabled")}},set_page:function(f){c(".variations-pagenav .page-selector").val(f).first().change()},go_to_page:function(f,g){f=f||1;g=g||0;e.set_paginav(g);e.set_page(f)},page_selector:function(){var f=parseInt(c(this).val(),10),g=c("#variable_product_options").find(".woocommerce_variations");c(".variations-pagenav .page-selector").val(f);b.check_for_changes();e.change_classes(f,parseInt(g.attr("data-total_pages"),10));b.load_variations(f)},first_page:function(){if(e.check_is_enabled(this)){e.set_page(1)}return false},prev_page:function(){if(e.check_is_enabled(this)){var h=c("#variable_product_options").find(".woocommerce_variations"),g=parseInt(h.attr("data-page"),10)-1,f=(0<g)?g:1;e.set_page(f)}return false},next_page:function(){if(e.check_is_enabled(this)){var i=c("#variable_product_options").find(".woocommerce_variations"),g=parseInt(i.attr("data-total_pages"),10),h=parseInt(i.attr("data-page"),10)+1,f=(g>=h)?h:g;e.set_page(f)}return false},last_page:function(){if(e.check_is_enabled(this)){var f=c("#variable_product_options").find(".woocommerce_variations").attr("data-total_pages");e.set_page(f)}return false}};a.init();d.init();b.init();e.init()});