jQuery(function(q){q(function(){q('[id$="-all"] > ul.categorychecklist').each(function(){var a=q(this);var d=a.find(":checked").first();if(!d.length){return}var c=a.find("input").position().top;var b=d.position().top;a.closest(".tabs-panel").scrollTop(b-c+5)})});q("#upsell_product_data").bind("keypress",function(a){if(a.keyCode===13){return false}});q(".type_box").appendTo("#woocommerce-product-data .hndle span");q(function(){q("#woocommerce-product-data").find(".hndle").unbind("click.postboxes");q("#woocommerce-product-data").on("click",".hndle",function(a){if(q(a.target).filter("input, option, label, select").length){return}q("#woocommerce-product-data").toggleClass("closed")})});q("#catalog-visibility").find(".edit-catalog-visibility").click(function(){if(q("#catalog-visibility-select").is(":hidden")){q("#catalog-visibility-select").slideDown("fast");q(this).hide()}return false});q("#catalog-visibility").find(".save-post-visibility").click(function(){q("#catalog-visibility-select").slideUp("fast");q("#catalog-visibility").find(".edit-catalog-visibility").show();var a=q("input[name=_visibility]:checked").attr("data-label");if(q("input[name=_featured]").is(":checked")){a=a+", "+woocommerce_admin_meta_boxes.featured_label;q("input[name=_featured]").attr("checked","checked")}q("#catalog-visibility-display").text(a);return false});q("#catalog-visibility").find(".cancel-post-visibility").click(function(){q("#catalog-visibility-select").slideUp("fast");q("#catalog-visibility").find(".edit-catalog-visibility").show();var a=q("#current_visibility").val();var c=q("#current_featured").val();q("input[name=_visibility]").removeAttr("checked");q("input[name=_visibility][value="+a+"]").attr("checked","checked");var b=q("input[name=_visibility]:checked").attr("data-label");if("yes"===c){b=b+", "+woocommerce_admin_meta_boxes.featured_label;q("input[name=_featured]").attr("checked","checked")}else{q("input[name=_featured]").removeAttr("checked")}q("#catalog-visibility-display").text(b);return false});q("select#product-type").change(function(){var a=q(this).val();if("variable"===a){q("input#_manage_stock").change();q("input#_downloadable").prop("checked",false);q("input#_virtual").removeAttr("checked")}else{if("grouped"===a){q("input#_downloadable").prop("checked",false);q("input#_virtual").removeAttr("checked")}else{if("external"===a){q("input#_downloadable").prop("checked",false);q("input#_virtual").removeAttr("checked")}}}l();q("ul.wc-tabs li:visible").eq(0).find("a").click();q(document.body).trigger("woocommerce-product-type-change",a,q(this))}).change();q("input#_downloadable, input#_virtual").change(function(){l()});function l(){var a=q("select#product-type").val();var c=q("input#_virtual:checked").length;var d=q("input#_downloadable:checked").length;var e=".hide_if_downloadable, .hide_if_virtual";var b=".show_if_downloadable, .show_if_virtual";q.each(woocommerce_admin_meta_boxes.product_types,function(g,f){e=e+", .hide_if_"+f;b=b+", .show_if_"+f});q(e).show();q(b).hide();if(d){q(".show_if_downloadable").show()}if(c){q(".show_if_virtual").show()}q(".show_if_"+a).show();if(d){q(".hide_if_downloadable").hide()}if(c){q(".hide_if_virtual").hide()}q(".hide_if_"+a).hide();q("input#_manage_stock").change();q(".woocommerce_options_panel").each(function(){var h=q(this).children(".options_group");if(0===h.length){return}var g=h.filter(function(){return"none"===q(this).css("display")});if(g.length===h.length){var f=q(this).prop("id");q(".product_data_tabs").find('li a[href="#'+f+'"]').parent().hide()}})}q(".sale_price_dates_fields").each(function(){var b=q(this);var a=false;var c=b.closest("div, table");b.find("input").each(function(){if(""!==q(this).val()){a=true}});if(a){c.find(".sale_schedule").hide();c.find(".sale_price_dates_fields").show()}else{c.find(".sale_schedule").show();c.find(".sale_price_dates_fields").hide()}});q("#woocommerce-product-data").on("click",".sale_schedule",function(){var a=q(this).closest("div, table");q(this).hide();a.find(".cancel_sale_schedule").show();a.find(".sale_price_dates_fields").show();return false});q("#woocommerce-product-data").on("click",".cancel_sale_schedule",function(){var a=q(this).closest("div, table");q(this).hide();a.find(".sale_schedule").show();a.find(".sale_price_dates_fields").hide();a.find(".sale_price_dates_fields").find("input").val("");return false});q("#woocommerce-product-data").on("click",".downloadable_files a.insert",function(){q(this).closest(".downloadable_files").find("tbody").append(q(this).data("row"));return false});q("#woocommerce-product-data").on("click",".downloadable_files a.delete",function(){q(this).closest("tr").remove();return false});q("input#_manage_stock").change(function(){if(q(this).is(":checked")){q("div.stock_fields").show()}else{q("div.stock_fields").hide()}}).change();function r(a){var b=q(a).next().is(".hasDatepicker")?"minDate":"maxDate",d="minDate"===b?q(a).next():q(a).prev(),c=q(a).datepicker("getDate");q(d).datepicker("option",b,c);q(a).change()}q(".sale_price_dates_fields").each(function(){q(this).find("input").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:true,onSelect:function(){r(q(this))}});q(this).find("input").each(function(){r(q(this))})});var k=q(".product_attributes").find(".woocommerce_attribute").get();k.sort(function(b,c){var d=parseInt(q(b).attr("rel"),10);var a=parseInt(q(c).attr("rel"),10);return(d<a)?-1:(d>a)?1:0});q(k).each(function(b,a){q(".product_attributes").append(a)});function p(){q(".product_attributes .woocommerce_attribute").each(function(b,a){q(".attribute_position",a).val(parseInt(q(a).index(".product_attributes .woocommerce_attribute"),10))})}q(".product_attributes .woocommerce_attribute").each(function(b,a){if(q(a).css("display")!=="none"&&q(a).is(".taxonomy")){q("select.attribute_taxonomy").find('option[value="'+q(a).data("taxonomy")+'"]').attr("disabled","disabled")}});q("button.add_attribute").on("click",function(){var b=q(".product_attributes .woocommerce_attribute").length;var a=q("select.attribute_taxonomy").val();var e=q(this).closest("#product_attributes");var c=e.find(".product_attributes");var d=q("select#product-type").val();var f={action:"woocommerce_add_attribute",taxonomy:a,i:b,security:woocommerce_admin_meta_boxes.add_attribute_nonce};e.block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});q.post(woocommerce_admin_meta_boxes.ajax_url,f,function(g){c.append(g);if("variable"!==d){c.find(".enable_variation").hide()}q(document.body).trigger("wc-enhanced-select-init");p();e.unblock();q(document.body).trigger("woocommerce_added_attribute")});if(a){q("select.attribute_taxonomy").find('option[value="'+a+'"]').attr("disabled","disabled");q("select.attribute_taxonomy").val("")}return false});q(".product_attributes").on("blur","input.attribute_name",function(){q(this).closest(".woocommerce_attribute").find("strong.attribute_name").text(q(this).val())});q(".product_attributes").on("click","button.select_all_attributes",function(){q(this).closest("td").find("select option").attr("selected","selected");q(this).closest("td").find("select").change();return false});q(".product_attributes").on("click","button.select_no_attributes",function(){q(this).closest("td").find("select option").removeAttr("selected");q(this).closest("td").find("select").change();return false});q(".product_attributes").on("click",".remove_row",function(){if(window.confirm(woocommerce_admin_meta_boxes.remove_attribute)){var a=q(this).parent().parent();if(a.is(".taxonomy")){a.find("select, input[type=text]").val("");a.hide();q("select.attribute_taxonomy").find('option[value="'+a.data("taxonomy")+'"]').removeAttr("disabled")}else{a.find("select, input[type=text]").val("");a.hide();p()}}return false});q(".product_attributes").sortable({items:".woocommerce_attribute",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:true,helper:"clone",opacity:0.65,placeholder:"wc-metabox-sortable-placeholder",start:function(b,a){a.item.css("background-color","#f6f6f6")},stop:function(b,a){a.item.removeAttr("style");p()}});q(".product_attributes").on("click","button.add_new_attribute",function(){q(".product_attributes").block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});var d=q(this).closest(".woocommerce_attribute");var b=d.data("taxonomy");var c=window.prompt(woocommerce_admin_meta_boxes.new_attribute_prompt);if(c){var a={action:"woocommerce_add_new_attribute",taxonomy:b,term:c,security:woocommerce_admin_meta_boxes.add_attribute_nonce};q.post(woocommerce_admin_meta_boxes.ajax_url,a,function(e){if(e.error){window.alert(e.error)}else{if(e.slug){d.find("select.attribute_values").append('<option value="'+e.term_id+'" selected="selected">'+e.name+"</option>");d.find("select.attribute_values").change()}}q(".product_attributes").unblock()})}else{q(".product_attributes").unblock()}return false});q(".save_attributes").on("click",function(){q("#woocommerce-product-data").block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});var a={post_id:woocommerce_admin_meta_boxes.post_id,product_type:q("#product-type").val(),data:q(".product_attributes").find("input, select, textarea").serialize(),action:"woocommerce_save_attributes",security:woocommerce_admin_meta_boxes.save_attributes_nonce};q.post(woocommerce_admin_meta_boxes.ajax_url,a,function(){var b=window.location.toString();b=b.replace("post-new.php?","post.php?post="+woocommerce_admin_meta_boxes.post_id+"&action=edit&");q("#variable_product_options").load(b+" #variable_product_options_inner",function(){q("#variable_product_options").trigger("reload")})})});var m;var s;q(document.body).on("click",".upload_file_button",function(b){var c=q(this);s=c.closest("tr").find("td.file_url input");b.preventDefault();if(m){m.open();return}var a=[new wp.media.controller.Library({library:wp.media.query(),multiple:true,title:c.data("choose"),priority:20,filterable:"uploaded"})];m=wp.media.frames.downloadable_file=wp.media({title:c.data("choose"),library:{type:""},button:{text:c.data("update")},multiple:true,states:a});m.on("select",function(){var e="";var d=m.state().get("selection");d.map(function(f){f=f.toJSON();if(f.url){e=f.url}});s.val(e).change()});m.on("ready",function(){m.uploader.options.uploader.params={type:"downloadable_product"}});m.open()});q(".downloadable_files tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,forcePlaceholderSize:true,helper:"clone",opacity:0.65});var t;var n=q("#product_image_gallery");var o=q("#product_images_container").find("ul.product_images");q(".add_product_images").on("click","a",function(a){var b=q(this);a.preventDefault();if(t){t.open();return}t=wp.media.frames.product_gallery=wp.media({title:b.data("choose"),button:{text:b.data("update")},states:[new wp.media.controller.Library({title:b.data("choose"),filterable:"all",multiple:true})]});t.on("select",function(){var c=t.state().get("selection");var d=n.val();c.map(function(e){e=e.toJSON();if(e.id){d=d?d+","+e.id:e.id;var f=e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail.url:e.url;o.append('<li class="image" data-attachment_id="'+e.id+'"><img src="'+f+'" /><ul class="actions"><li><a href="#" class="delete" title="'+b.data("delete")+'">'+b.data("text")+"</a></li></ul></li>")}});n.val(d)});t.open()});o.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:true,forceHelperSize:false,helper:"clone",opacity:0.65,placeholder:"wc-metabox-sortable-placeholder",start:function(b,a){a.item.css("background-color","#f6f6f6")},stop:function(b,a){a.item.removeAttr("style")},update:function(){var a="";q("#product_images_container").find("ul li.image").css("cursor","default").each(function(){var b=q(this).attr("data-attachment_id");a=a+b+","});n.val(a)}});q("#product_images_container").on("click","a.delete",function(){q(this).closest("li.image").remove();var a="";q("#product_images_container").find("ul li.image").css("cursor","default").each(function(){var b=q(this).attr("data-attachment_id");a=a+b+","});n.val(a);q("#tiptip_holder").removeAttr("style");q("#tiptip_arrow").removeAttr("style");return false})});