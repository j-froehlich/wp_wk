jQuery(function(b){var a={$parcelFinderButtonWrapper:b(wc_gzd_dhl_parcel_shops_params.button_wrapper),$parcelFinderWrapper:b(wc_gzd_dhl_parcel_shops_params.iframe_wrapper),$parcelCheckboxField:b("#shipping_parcelshop_field"),params:wc_gzd_dhl_parcel_shops_params,defaultAddressFieldLabel:"",defaultAddressFieldPlaceholder:"",supportedCountries:[],init:function(){if(a.params.enable_finder){this.initParcelFinder()}this.initDefaultData();this.$parcelCheckboxField.on("change","#shipping_parcelshop",this.parcelCheckboxChanged);b(document).on("change","#shipping_country",this.shippingCountryChanged);this.parcelCheckboxChanged(true)},initDefaultData:function(){this.supportedCountries=this.params.supported_countries;this.defaultAddressFieldLabel=b("#shipping_address_1_field").find("label").contents().filter(function(){return this.nodeType==3}).text();this.defaultAddressFieldPlaceholder=b("#shipping_address_1").attr("placeholder")},shippingCountryChanged:function(){var c=b("#shipping_country").val();if(b.inArray(c,a.params.supported_countries)!==-1){a.$parcelCheckboxField.show()}else{b("#shipping_parcelshop").prop("checked",false);a.$parcelCheckboxField.hide()}a.parcelCheckboxChanged(false)},parcelCheckboxChanged:function(d){if(typeof d==="undefined"||b.type(d)!=="boolean"){d=false}var c=b("#shipping_address_1_field").find("label");if(b("#shipping_parcelshop").is(":checked")){a.showFinderButton();if(!d&&a.$parcelCheckboxField.hasClass("first-check")){b("#shipping_address_1").val("");a.$parcelCheckboxField.removeClass("first-check")}else{if(d){a.$parcelCheckboxField.removeClass("first-check")}}b("#shipping_parcelshop_post_number_field").show();c.contents().filter(function(){return this.nodeType==3}).first().replaceWith(a.params.address_field_title+" ");b("#shipping_address_1").attr("placeholder",a.params.address_field_placeholder);if(b("#shipping_country").val()==="DE"){b("#shipping_address_2").val("");b("#shipping_address_2").addClass("gzd-hidden").hide()}else{b("#shipping_address_2").show()}}else{a.hideFinderButton();c.contents().filter(function(){return this.nodeType==3}).first().replaceWith(a.defaultAddressFieldLabel);if(b("#shipping_address_2").hasClass("gzd-hidden")){b("#shipping_address_2").show();b("#shipping_address_2").removeClass("gzd-hidden")}b("#shipping_address_1").attr("placeholder",a.defaultAddressFieldPlaceholder);b("#shipping_parcelshop_post_number_field").hide()}},initParcelFinder:function(){this.$parcelFinderButtonWrapper.hide();this.$parcelFinderWrapper.find("#wc-gzd-parcel-finder-background-overlay").hide();this.$parcelFinderWrapper.on("click","#wc-gzd-parcel-finder-background-overlay",this.closeParcelFinder);this.$parcelFinderWrapper.on("click","#wc-gzd-parcel-finder-close-btn",this.closeParcelFinder);this.$parcelFinderButtonWrapper.on("click",".wc-gzd-parcel-finder-open-button",this.openParcelFinder);b(window).on("message",this.saveParcelFinder)},showFinderButton:function(){if(a.params.enable_finder){a.$parcelFinderButtonWrapper.show()}},hideFinderButton:function(){if(a.params.enable_finder){a.$parcelFinderButtonWrapper.hide()}},isValidJSON:function(d){try{JSON.parse(d)}catch(c){return false}return true},saveParcelFinder:function(d){if(d.originalEvent.data==="undefined"){return}if(!a.isValidJSON(d.originalEvent.data)){return}var g=JSON.parse(d.originalEvent.data);if(typeof g!=="object"){return}if(!g.countryCode){return}var f=g.countryCode.toUpperCase();b(".wc-gzd-parcel-finder-shipping-country-error").remove();if(b.inArray(f,a.supportedCountries)!==-1){b("#shipping_country").val(g.countryCode.toUpperCase()).trigger("change");b("#shipping_address_1").val(g.keyWord+" "+g.primaryKeyZipRegion);b("#shipping_address_2").val(g.street+" "+g.houseNo);b("#shipping_city").val(g.city);b("#shipping_postcode").val(g.zipCode)}else{if(b(".woocommerce-error").length>0){b(".woocommerce-error").append('<li class="wc-gzd-parcel-finder-shipping-country-error">'+a.params.shipping_country_error+"</li>")}else{b("form.woocommerce-checkout").prepend('<ul class="woocommerce-error wc-gzd-parcel-finder-shipping-country-error"><li>'+a.params.shipping_country_error+"</li></ul>")}b("html, body").animate({scrollTop:(b("form.checkout").offset().top-100)},1000)}if(g.countryCode==="de"){b("#shipping_address_2").val("")}a.closeParcelFinder()},openParcelFinder:function(){a.$parcelFinderWrapper.find("iframe").attr("src",a.params.iframe_src);a.$parcelFinderWrapper.find("#wc-gzd-parcel-finder-background-overlay").show();return false},closeParcelFinder:function(){a.$parcelFinderWrapper.find("#wc-gzd-parcel-finder-background-overlay").hide()}};a.init()});