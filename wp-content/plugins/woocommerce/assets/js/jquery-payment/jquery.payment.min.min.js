jQuery(function(b){(function(){var X,O,U,P,M,J,F,G,Q,L,E,S,D,B,N,H,V,I,C,a,R,T,A,K=[].slice,W=[].indexOf||function(d){for(var e=0,c=this.length;e<c;e++){if(e in this&&this[e]===d){return e}}return -1};b=window.jQuery||window.Zepto||window.$;b.payment={};b.payment.fn={};b.fn.payment=function(){var c,d;d=arguments[0],c=2<=arguments.length?K.call(arguments,1):[];return b.payment.fn[d].apply(this,c)};P=/(\d{1,4})/g;b.payment.cards=U=[{type:"maestro",patterns:[5018,502,503,506,56,58,639,6220,67],format:P,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:true},{type:"forbrugsforeningen",patterns:[600],format:P,length:[16],cvcLength:[3],luhn:true},{type:"dankort",patterns:[5019],format:P,length:[16],cvcLength:[3],luhn:true},{type:"visa",patterns:[4],format:P,length:[13,16],cvcLength:[3],luhn:true},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:P,length:[16],cvcLength:[3],luhn:true},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:true},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:true},{type:"discover",patterns:[60,64,65,622],format:P,length:[16],cvcLength:[3],luhn:true},{type:"unionpay",patterns:[62,88],format:P,length:[16,17,18,19],cvcLength:[3],luhn:false},{type:"jcb",patterns:[35],format:P,length:[16],cvcLength:[3],luhn:true}];X=function(i){var d,f,h,k,c,g,e,j;i=(i+"").replace(/\D/g,"");for(k=0,g=U.length;k<g;k++){d=U[k];j=d.patterns;for(c=0,e=j.length;c<e;c++){h=j[c];f=h+"";if(i.substr(0,f.length)===f){return d}}}};O=function(e){var f,d,c;for(d=0,c=U.length;d<c;d++){f=U[d];if(f.type===e){return f}}};S=function(i){var d,e,f,h,g,c;f=true;h=0;e=(i+"").split("").reverse();for(g=0,c=e.length;g<c;g++){d=e[g];d=parseInt(d,10);if((f=!f)){d*=2}if(d>9){d-=9}h+=d}return h%10===0};E=function(c){var d;if((c.prop("selectionStart")!=null)&&c.prop("selectionStart")!==c.prop("selectionEnd")){return true}if((typeof document!=="undefined"&&document!==null?(d=document.selection)!=null?d.createRange:void 0:void 0)!=null){if(document.selection.createRange().text){return true}}return false};T=function(j,f){var d,g,k,c,h,e;try{g=f.prop("selectionStart")}catch(i){c=i;g=null}h=f.val();f.val(j);if(g!==null&&f.is(":focus")){if(g===h.length){g=j.length}if(h!==j){e=h.slice(g-1,+g+1||9000000000);d=j.slice(g-1,+g+1||9000000000);k=j[g];if(/\d/.test(k)&&e===(""+k+" ")&&d===(" "+k)){g=g+1}}f.prop("selectionStart",g);return f.prop("selectionEnd",g)}};V=function(c){var k,e,i,d,g,h,f,j;if(c==null){c=""}i="\uff10\uff11\uff12\uff13\uff14\uff15\uff16\uff17\uff18\uff19";d="0123456789";h="";k=c.split("");for(f=0,j=k.length;f<j;f++){e=k[f];g=i.indexOf(e);if(g>-1){e=d[g]}h+=e}return h};H=function(d){var c;c=b(d.currentTarget);return setTimeout(function(){var e;e=c.val();e=V(e);e=e.replace(/\D/g,"");return T(e,c)})};B=function(d){var c;c=b(d.currentTarget);return setTimeout(function(){var e;e=c.val();e=V(e);e=b.payment.formatCardNumber(e);return T(e,c)})};F=function(f){var c,j,d,h,i,e,g;d=String.fromCharCode(f.which);if(!/^\d+$/.test(d)){return}c=b(f.currentTarget);g=c.val();j=X(g+d);h=(g.replace(/\D/g,"")+d).length;e=16;if(j){e=j.length[j.length.length-1]}if(h>=e){return}if((c.prop("selectionStart")!=null)&&c.prop("selectionStart")!==g.length){return}if(j&&j.type==="amex"){i=/^(\d{4}|\d{4}\s\d{6})$/}else{i=/(?:^|\s)(\d{4})$/}if(i.test(g)){f.preventDefault();return setTimeout(function(){return c.val(g+" "+d)})}else{if(i.test(g+d)){f.preventDefault();return setTimeout(function(){return c.val(g+d+" ")})}}};M=function(d){var c,e;c=b(d.currentTarget);e=c.val();if(d.which!==8){return}if((c.prop("selectionStart")!=null)&&c.prop("selectionStart")!==e.length){return}if(/\d\s$/.test(e)){d.preventDefault();return setTimeout(function(){return c.val(e.replace(/\d\s$/,""))})}else{if(/\s\d?$/.test(e)){d.preventDefault();return setTimeout(function(){return c.val(e.replace(/\d$/,""))})}}};N=function(d){var c;c=b(d.currentTarget);return setTimeout(function(){var e;e=c.val();e=V(e);e=b.payment.formatExpiry(e);return T(e,c)})};G=function(f){var c,d,e;d=String.fromCharCode(f.which);if(!/^\d+$/.test(d)){return}c=b(f.currentTarget);e=c.val()+d;if(/^\d$/.test(e)&&(e!=="0"&&e!=="1")){f.preventDefault();return setTimeout(function(){return c.val("0"+e+" / ")})}else{if(/^\d\d$/.test(e)){f.preventDefault();return setTimeout(function(){var g,h;g=parseInt(e[0],10);h=parseInt(e[1],10);if(h>2&&g!==0){return c.val("0"+g+" / "+h)}else{return c.val(""+e+" / ")}})}}};Q=function(f){var c,d,e;d=String.fromCharCode(f.which);if(!/^\d+$/.test(d)){return}c=b(f.currentTarget);e=c.val();if(/^\d\d$/.test(e)){return c.val(""+e+" / ")}};L=function(f){var c,d,e;e=String.fromCharCode(f.which);if(!(e==="/"||e===" ")){return}c=b(f.currentTarget);d=c.val();if(/^\d$/.test(d)&&d!=="0"){return c.val("0"+d+" / ")}};J=function(d){var c,e;c=b(d.currentTarget);e=c.val();if(d.which!==8){return}if((c.prop("selectionStart")!=null)&&c.prop("selectionStart")!==e.length){return}if(/\d\s\/\s$/.test(e)){d.preventDefault();return setTimeout(function(){return c.val(e.replace(/\d\s\/\s$/,""))})}};D=function(d){var c;c=b(d.currentTarget);return setTimeout(function(){var e;e=c.val();e=V(e);e=e.replace(/\D/g,"").slice(0,4);return T(e,c)})};R=function(d){var c;if(d.metaKey||d.ctrlKey){return true}if(d.which===32){return false}if(d.which===0){return true}if(d.which<33){return true}c=String.fromCharCode(d.which);return !!/[\d\s]/.test(c)};C=function(e){var c,g,d,f;c=b(e.currentTarget);d=String.fromCharCode(e.which);if(!/^\d+$/.test(d)){return}if(E(c)){return}f=(c.val()+d).replace(/\D/g,"");g=X(f);if(g){return f.length<=g.length[g.length.length-1]}else{return f.length<=16}};a=function(e){var c,d,f;c=b(e.currentTarget);d=String.fromCharCode(e.which);if(!/^\d+$/.test(d)){return}if(E(c)){return}f=c.val()+d;f=f.replace(/\D/g,"");if(f.length>6){return false}};I=function(f){var c,d,e;c=b(f.currentTarget);d=String.fromCharCode(f.which);if(!/^\d+$/.test(d)){return}if(E(c)){return}e=c.val()+d;return e.length<=4};A=function(e){var h,f,g,c,d;h=b(e.currentTarget);d=h.val();c=b.payment.cardType(d)||"unknown";if(!h.hasClass(c)){f=(function(){var i,j,k;k=[];for(i=0,j=U.length;i<j;i++){g=U[i];k.push(g.type)}return k})();h.removeClass("unknown");h.removeClass(f.join(" "));h.addClass(c);h.toggleClass("identified",c!=="unknown");return h.trigger("payment.cardType",c)}};b.payment.fn.formatCardCVC=function(){this.on("keypress",R);this.on("keypress",I);this.on("paste",D);this.on("change",D);this.on("input",D);return this};b.payment.fn.formatCardExpiry=function(){this.on("keypress",R);this.on("keypress",a);this.on("keypress",G);this.on("keypress",L);this.on("keypress",Q);this.on("keydown",J);this.on("change",N);this.on("input",N);return this};b.payment.fn.formatCardNumber=function(){this.on("keypress",R);this.on("keypress",C);this.on("keypress",F);this.on("keydown",M);this.on("keyup",A);this.on("paste",B);this.on("change",B);this.on("input",B);this.on("input",A);return this};b.payment.fn.restrictNumeric=function(){this.on("keypress",R);this.on("paste",H);this.on("change",H);this.on("input",H);return this};b.payment.fn.cardExpiryVal=function(){return b.payment.cardExpiryVal(b(this).val())};b.payment.cardExpiryVal=function(e){var d,f,c,g;g=e.split(/[\s\/]+/,2),d=g[0],c=g[1];if((c!=null?c.length:void 0)===2&&/^\d+$/.test(c)){f=(new Date).getFullYear();f=f.toString().slice(0,2);c=f+c}d=parseInt(d,10);c=parseInt(c,10);return{month:d,year:c}};b.payment.validateCardNumber=function(e){var c,d;e=(e+"").replace(/\s+|-/g,"");if(!/^\d+$/.test(e)){return false}c=X(e);if(!c){return false}return(d=e.length,W.call(c.length,d)>=0)&&(c.luhn===false||S(e))};b.payment.validateCardExpiry=function(d,g){var f,c,e;if(typeof d==="object"&&"month" in d){e=d,d=e.month,g=e.year}if(!(d&&g)){return false}d=b.trim(d);g=b.trim(g);if(!/^\d+$/.test(d)){return false}if(!/^\d+$/.test(g)){return false}if(!((1<=d&&d<=12))){return false}if(g.length===2){if(g<70){g="20"+g}else{g="19"+g}}if(g.length!==4){return false}c=new Date(g,d);f=new Date;c.setMonth(c.getMonth()-1);c.setMonth(c.getMonth()+1,1);return c>f};b.payment.validateCardCVC=function(f,e){var c,d;f=b.trim(f);if(!/^\d+$/.test(f)){return false}c=O(e);if(c!=null){return d=f.length,W.call(c.cvcLength,d)>=0}else{return f.length>=3&&f.length<=4}};b.payment.cardType=function(c){var d;if(!c){return null}return((d=X(c))!=null?d.type:void 0)||null};b.payment.formatCardNumber=function(f){var g,c,d,e;f=f.replace(/\D/g,"");g=X(f);if(!g){return f}d=g.length[g.length.length-1];f=f.slice(0,d);if(g.format.global){return(e=f.match(g.format))!=null?e.join(" "):void 0}else{c=g.format.exec(f);if(c==null){return}c.shift();c=b.grep(c,function(h){return h});return c.join(" ")}};b.payment.formatExpiry=function(g){var e,d,c,f;d=g.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/);if(!d){return""}e=d[1]||"";c=d[2]||"";f=d[3]||"";if(f.length>0){c=" / "}else{if(c===" /"){e=e.substring(0,1);c=""}else{if(e.length===2||c.length>0){c=" / "}else{if(e.length===1&&(e!=="0"&&e!=="1")){e="0"+e;c=" / "}}}}return e+c+f}}).call(this)});