jQuery(function(e){function g(a,i,h){e('<div class="chart-tooltip">'+h+"</div>").css({top:i-16,left:a+20}).appendTo("body").fadeIn(200)}var c=null;var d=null;e(".chart-placeholder").bind("plothover",function(h,k,a){if(a){if(c!==a.dataIndex||d!==a.seriesIndex){c=a.dataIndex;d=a.seriesIndex;e(".chart-tooltip").remove();if(a.series.points.show||a.series.enable_tooltip){var j=a.series.data[a.dataIndex][1],i="";if(a.series.prepend_label){i=i+a.series.label+": "}if(a.series.prepend_tooltip){i=i+a.series.prepend_tooltip}i=i+j;if(a.series.append_tooltip){i=i+a.series.append_tooltip}if(a.series.pie.show){g(k.pageX,k.pageY,i)}else{g(a.pageX,a.pageY,i)}}}}else{e(".chart-tooltip").remove();c=null}});e(".wc_sparkline.bars").each(function(){var i=e(this).data("sparkline");var a={grid:{show:false}};var h=[{data:i,color:e(this).data("color"),bars:{fillColor:e(this).data("color"),fill:true,show:true,lineWidth:1,barWidth:e(this).data("barwidth"),align:"center"},shadowSize:0}];e.plot(e(this),h,a)});e(".wc_sparkline.lines").each(function(){var i=e(this).data("sparkline");var a={grid:{show:false}};var h=[{data:i,color:e(this).data("color"),lines:{fill:false,show:true,lineWidth:1,align:"center"},shadowSize:0}];e.plot(e(this),h,a)});var f=e(".range_datepicker").datepicker({changeMonth:true,changeYear:true,defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,minDate:"-20Y",maxDate:"+1D",showButtonPanel:true,showOn:"focus",buttonImageOnly:true,onSelect:function(){var h=e(this).is(".from")?"minDate":"maxDate",a=e(this).datepicker("getDate");f.not(this).datepicker("option",h,a)}});var b=document.createElement("a");if(typeof b.download==="undefined"){e(".export_csv").hide()}e(".export_csv").click(function(){var n=e(this).data("exclude_series")||"";n=n.toString();n=n.split(",");var m=e(this).data("xaxes");var p=e(this).data("groupby");var r=e(this).data("index_type");var a=e(this).data("export");var u="data:text/csv;charset=utf-8,\uFEFF";var t,h,o;if("table"===a){e(this).offsetParent().find("thead tr,tbody tr").each(function(){e(this).find("th, td").each(function(){var i=e(this).text();i=i.replace("[?]","").replace("#","");u+='"'+i+'",'});u=u.substring(0,u.length-1);u+="\n"});e(this).offsetParent().find("tfoot tr").each(function(){e(this).find("th, td").each(function(){var i=e(this).text();i=i.replace("[?]","").replace("#","");u+='"'+i+'",';if(e(this).attr("colspan")>0){for(j=1;j<e(this).attr("colspan");j++){u+='"",'}}});u=u.substring(0,u.length-1);u+="\n"})}else{if(!window.main_chart){return false}var l=window.main_chart.getData();var k=[];u+='"'+m+'",';e.each(l,function(i,s){if(!n||e.inArray(i.toString(),n)===-1){k.push(s)}});for(t=0;t<k.length;++t){u+='"'+k[t].label+'",'}u=u.substring(0,u.length-1);u+="\n";var q={};for(t=0;t<k.length;++t){h=k[t].data;for(o=0;o<h.length;++o){q[h[o][0]]=[];for(var j=0;j<k.length;++j){q[h[o][0]].push(0)}}}for(t=0;t<k.length;++t){h=k[t].data;for(o=0;o<h.length;++o){q[h[o][0]][t]=h[o][1]}}e.each(q,function(s,v){var i=new Date(parseInt(s,10));if("none"===r){u+='"'+s+'",'}else{if(p==="day"){u+='"'+i.getUTCFullYear()+"-"+parseInt(i.getUTCMonth()+1,10)+"-"+i.getUTCDate()+'",'}else{u+='"'+i.getUTCFullYear()+"-"+parseInt(i.getUTCMonth()+1,10)+'",'}}for(var x=0;x<v.length;++x){var w=v[x];if(Math.round(w)!==w){w=parseFloat(w);w=w.toFixed(2)}u+='"'+w+'",'}u=u.substring(0,u.length-1);u+="\n"})}e(this).attr("href",encodeURI(u));return true})});