jQuery(function(j){function h(b,c,d){j('<div class="chart-tooltip">'+d+"</div>").css({top:c-16,left:b+20}).appendTo("body").fadeIn(200)}var l=null;var k=null;j(".chart-placeholder").bind("plothover",function(f,c,b){if(b){if(l!==b.dataIndex||k!==b.seriesIndex){l=b.dataIndex;k=b.seriesIndex;j(".chart-tooltip").remove();if(b.series.points.show||b.series.enable_tooltip){var d=b.series.data[b.dataIndex][1],e="";if(b.series.prepend_label){e=e+b.series.label+": "}if(b.series.prepend_tooltip){e=e+b.series.prepend_tooltip}e=e+d;if(b.series.append_tooltip){e=e+b.series.append_tooltip}if(b.series.pie.show){h(c.pageX,c.pageY,e)}else{h(b.pageX,b.pageY,e)}}}}else{j(".chart-tooltip").remove();l=null}});j(".wc_sparkline.bars").each(function(){var c=j(this).data("sparkline");var b={grid:{show:false}};var d=[{data:c,color:j(this).data("color"),bars:{fillColor:j(this).data("color"),fill:true,show:true,lineWidth:1,barWidth:j(this).data("barwidth"),align:"center"},shadowSize:0}];j.plot(j(this),d,b)});j(".wc_sparkline.lines").each(function(){var c=j(this).data("sparkline");var b={grid:{show:false}};var d=[{data:c,color:j(this).data("color"),lines:{fill:false,show:true,lineWidth:1,align:"center"},shadowSize:0}];j.plot(j(this),d,b)});var i=j(".range_datepicker").datepicker({changeMonth:true,changeYear:true,defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,minDate:"-20Y",maxDate:"+1D",showButtonPanel:true,showOn:"focus",buttonImageOnly:true,onSelect:function(){var c=j(this).is(".from")?"minDate":"maxDate",b=j(this).datepicker("getDate");i.not(this).datepicker("option",c,b)}});var a=document.createElement("a");if(typeof a.download==="undefined"){j(".export_csv").hide()}j(".export_csv").click(function(){var f=j(this).data("exclude_series")||"";f=f.toString();f=f.split(",");var g=j(this).data("xaxes");var d=j(this).data("groupby");var b=j(this).data("index_type");var y=j(this).data("export");var z="data:text/csv;charset=utf-8,\uFEFF";var A,x,e;if("table"===y){j(this).offsetParent().find("thead tr,tbody tr").each(function(){j(this).find("th, td").each(function(){var m=j(this).text();m=m.replace("[?]","").replace("#","");z+='"'+m+'",'});z=z.substring(0,z.length-1);z+="\n"});j(this).offsetParent().find("tfoot tr").each(function(){j(this).find("th, td").each(function(){var m=j(this).text();m=m.replace("[?]","").replace("#","");z+='"'+m+'",';if(j(this).attr("colspan")>0){for(w=1;w<j(this).attr("colspan");w++){z+='"",'}}});z=z.substring(0,z.length-1);z+="\n"})}else{if(!window.main_chart){return false}var s=window.main_chart.getData();var v=[];z+='"'+g+'",';j.each(s,function(m,n){if(!f||j.inArray(m.toString(),f)===-1){v.push(n)}});for(A=0;A<v.length;++A){z+='"'+v[A].label+'",'}z=z.substring(0,z.length-1);z+="\n";var c={};for(A=0;A<v.length;++A){x=v[A].data;for(e=0;e<x.length;++e){c[x[e][0]]=[];for(var w=0;w<v.length;++w){c[x[e][0]].push(0)}}}for(A=0;A<v.length;++A){x=v[A].data;for(e=0;e<x.length;++e){c[x[e][0]][A]=x[e][1]}}j.each(c,function(q,o){var p=new Date(parseInt(q,10));if("none"===b){z+='"'+q+'",'}else{if(d==="day"){z+='"'+p.getUTCFullYear()+"-"+parseInt(p.getUTCMonth()+1,10)+"-"+p.getUTCDate()+'",'}else{z+='"'+p.getUTCFullYear()+"-"+parseInt(p.getUTCMonth()+1,10)+'",'}}for(var m=0;m<o.length;++m){var n=o[m];if(Math.round(n)!==n){n=parseFloat(n);n=n.toFixed(2)}z+='"'+n+'",'}z=z.substring(0,z.length-1);z+="\n"})}j(this).attr("href",encodeURI(z));return true})});