define(["models/formModel"],function(a){var b=Backbone.Collection.extend({model:a,comparator:"title",tmpNum:1,url:function(){return ajaxurl+"?action=nf_forms"},initialize:function(){this.newIDs=[];this.listenTo(nfRadio.channel("dashboard"),"forms:delete",this.modalConfirm);this.listenTo(nfRadio.channel("dashboard"),"forms:duplicate",this.duplicate);this.modal=new jBox("Modal",{width:300,addClass:"dashboard-modal",overlay:true,closeOnClick:"body"})},parse:function(c,d){return c.data},modalConfirm:function(c){var f='<div class="message"><p>Once deleted, a Form cannot be recovered.<br />Are you sure you want to delete <em>'+c.model.get("title")+"</em>?</p></div>";f+='<div class="buttons"><div class="confirm nf-button primary">Delete</div> <div style="float:right;" class="cancel nf-button secondary">Cancel</div></div>';this.modal.setContent(f);this.modal.setTitle("Confirm Delete");this.modal.open();var e=this;var g=this.modal.container[0].getElementsByClassName("cancel")[0];g.addEventListener("click",function(){e.modalClose()});var d=this.modal.container[0].getElementsByClassName("confirm")[0];d.addEventListener("click",function(){e.confirmDelete(c)})},modalClose:function(){this.modal.close()},confirmDelete:function(c){jQuery(c.el).removeClass("show-actions");jQuery(c.el).addClass("deleting");jQuery(c.el).animate({opacity:0,"line-height":0,display:"none"},500);c.model.destroy();this.modalClose()},duplicate:function(c){var e='<div class="message">Duplicating <em>'+c.model.get("title")+'</em>...<div class="nf-loading-spinner"></div></div>';this.modal.setContent(e);this.modal.setTitle("Please Wait");this.modal.open();var d=this;jQuery.ajax({type:"POST",url:ajaxurl+"?action=nf_forms&clone_id="+c.model.get("id"),success:function(g){var g=JSON.parse(g);var f=g.data.new_form_id;var h=c.model.clone();h.set({id:f,title:h.get("title")+" - copy",created_at:new Date()});h.initShortcode(f);c.model.collection.add(h);d.modalClose()}})}});return b});