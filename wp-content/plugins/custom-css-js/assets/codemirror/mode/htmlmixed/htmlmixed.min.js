"use strict";(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],a):a(CodeMirror)})(function(h){function g(d){var i=b[d];return i?i:b[d]=new RegExp("\\s+"+d+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*")}function f(d,i){return(d=d.match(g(i)))?/^\s*(.*?)\s*$/.exec(d[2])[1]:""}function a(k,n){for(var m in k){for(var j=n[m]||(n[m]=[]),i=k[m],l=i.length-1;0<=l;l--){j.unshift(i[l])}}}function e(k,l){for(var j=0;j<k.length;j++){var i=k[j];if(!i[0]||i[1].test(f(l,i[0]))){return i[2]}}}var c={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]},b={};h.defineMode("htmlmixed",function(l,n){function d(q,o){var t=j.token(q,o.htmlState),r=/\btag\b/.test(t),k;if(r&&!/[<>\s\/]/.test(q.current())&&(k=o.htmlState.tagName&&o.htmlState.tagName.toLowerCase())&&i.hasOwnProperty(k)){o.inTag=k+" "}else{if(o.inTag&&r&&/>$/.test(q.current())){r=/^([\S]+) (.*)/.exec(o.inTag);o.inTag=null;q=">"==q.current()&&e(i[r[1]],r[2]);q=h.getMode(l,q);var p=new RegExp("^</s*"+r[1]+"s*>","i"),s=new RegExp("</s*"+r[1]+"s*>","i");o.token=function(v,u){if(v.match(p,!1)){return u.token=d,u.localState=u.localMode=null}u=u.localMode.token(v,u.localState);var x=v.current(),w=x.search(s);-1<w?v.backUp(x.length-w):x.match(/<\/?$/)&&(v.backUp(x.length),v.match(s,!1)||v.match(x));return u};o.localMode=q;o.localState=h.startState(q,j.indent(o.htmlState,""))}else{o.inTag&&(o.inTag+=q.current(),q.eol()&&(o.inTag+=" "))}}return t}var j=h.getMode(l,{name:"xml",htmlMode:!0,multilineTagIndentFactor:n.multilineTagIndentFactor,multilineTagIndentPastTag:n.multilineTagIndentPastTag}),i={},m=n&&n.tags;n=n&&n.scriptTypes;a(c,i);m&&a(m,i);if(n){for(m=n.length-1;0<=m;m--){i.script.unshift(["type",n[m].matches,n[m].mode])}}return{startState:function(){var k=h.startState(j);return{token:d,inTag:null,localMode:null,localState:null,htmlState:k}},copyState:function(o){var k;o.localState&&(k=h.copyState(o.localMode,o.localState));return{token:o.token,inTag:o.inTag,localMode:o.localMode,localState:k,htmlState:h.copyState(j,o.htmlState)}},token:function(o,k){return k.token(o,k)},indent:function(o,k,p){return !o.localMode||/^\s*<\//.test(k)?j.indent(o.htmlState,k):o.localMode.indent?o.localMode.indent(o.localState,k,p):h.Pass},innerMode:function(k){return{state:k.localState||k.htmlState,mode:k.localMode||j}}}},"xml","javascript","css");h.defineMIME("text/html","htmlmixed")});