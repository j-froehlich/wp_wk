jQuery(document).ready(function(e){e(".nf-upgrade-complete").nfAdminModal({title:nfUpgradeHandler.nf_upgrade_complete_title,buttons:".nf-upgrade-complete-buttons"});function d(f){this.upgrade=f;this.process=function(i,g,h){i=typeof i!=="undefined"?i:0;total_step=typeof total_step!=="undefined"?total_step:0;h=typeof h!=="undefined"?h:[];console.log("Upgrade: "+this.upgrade);e.post(ajaxurl,{upgrade:this.upgrade,step:parseInt(i),total_steps:parseInt(g),args:h,action:"nf_upgrade_handler"},function(k){var m=e("#nf_upgrade_"+b.upgrade);try{k=e.parseJSON(k)}catch(n){m.find(".spinner").css("display","none").css("visibility","hidden");m.find(".dashicons-no").css("display","block");m.find(".nf-upgrade-handler__errors__text").html("Bad Response :'(<br/>"+n+"<br />"+k);m.find(".nf-upgrade-handler__errors").slideDown();return}console.log("DEBUG: NF_UpgradeHandler step response: ");console.log(k);if(undefined==k){m.find(".spinner").css("display","none").css("visibility","hidden");m.find(".dashicons-no").css("display","block");m.find(".nf-upgrade-handler__errors__text").html("Empty Response :'(");m.find(".nf-upgrade-handler__errors").slideDown();return}if(k.errors){m.find(".spinner").css("display","none").css("visibility","hidden");m.find(".dashicons-no").css("display","block");var l="";e.each(k.errors,function(p,o){l=l+"["+p+"] "+o+"<br />"});m.find(".nf-upgrade-handler__errors__text").html("Processing Error :'(<br />"+l);m.find(".nf-upgrade-handler__errors").slideDown();e("#progressbar_"+k.upgrade).slideUp();return}var j=e("#progressbar_"+k.upgrade).progressbar({value:100*(k.step/k.total_steps)});m.find(".spinner").css("display","block").css("visibility","visible");m.find(".dashicons-no").css("display","none");m.find(".inside").slideDown();if(undefined!=k.complete){m.find(".inside").slideUp();m.find(".spinner").css("display","none").css("visibility","hidden");m.find(".dashicons-yes").css("display","block");if(undefined!=k.nextUpgrade){b.upgrade=k.nextUpgrade;e("#nf_upgrade_"+b.upgrade).find(".spinner").css("display","block").css("visibility","visible");e("#nf_upgrade_"+b.upgrade).find(".inside").slideDown();b.process();return}console.log('DEBUG: NF_UpgradeHandler says "It is finished!"');e(".nf-upgrade-complete").nfAdminModal("open");return}b.process(k.step,k.total_steps,k.args)}).fail(function(){alert("error")})}}function c(f){this.name=f;this.elem="#nf_upgrade_"+f;this.open=function(){jQuery(this.elem).slideDown()};this.close=function(){jQuery(this.elem).slideUp()}}if("undefined"!=typeof nfUpgradeHandler){console.log("DEBUG: NF_UpgradeHandler first upgrades is "+nfUpgradeHandler.upgrade);var b=new d(nfUpgradeHandler.upgrade);e(".progressbar").progressbar({value:0});var a=e("#nf_upgrade_"+b.upgrade);a.find(".spinner").css("display","block").css("visibility","visible");a.find(".dashicons-no").css("display","none");a.find(".inside").slideDown();b.process()}else{document.location.href="admin.php?page=ninja-forms"}});