!function(a,b,c,d){"use strict";function e(b,c){this.$element=a(b),this.oSettings=a.extend(!0,{},e.oDefaults,c),this.ajaxOptions=this.oSettings.oAjaxOptions,this._post__not_in="",this._isSingleTerm=!1,this._term=null,this._currentPage=1,this._xhr=null,this._inView=null,this.initialize()}e.oDefaults={oAjaxOptions:{action:"wiloke_loadmore_portfolio",totalAjaxLoaded:0,security:"",term_ids:null,totalPostsOfTerm:0,post__not_in:null,number_of_loaded:10,post_type:"post",max_posts:0,additional:null},itemCssClass:".item",btnClass:".wiloke-btn-infinite-scroll",progressingClass:".wiloke-btn-infinite-scroll",isInfiniteScroll:!0,containerClass:".wiloke-infinite-scroll-wrapper",is_debug:!1,navFilterWrapperCssClass:".wiloke-nav-filter",navFiltersCssClass:".wiloke-nav-filter li",appendTo:".wiloke-items-store",windowWidth:a(b).outerWidth(),direction_enter:"down",direction_entered:"",direction_exit:"",direction_exited:""},e.prototype.beforeAppend=function(b){return a(b)},e.prototype.handleAppendItems=function(a){},e.prototype.afterAppended=function(){},e.prototype.beforeAppendToIsotope=function(){},e.prototype.afterAppendedIsotope=function(){},e.prototype.setup=function(){this.$container=this.$element.closest(this.oSettings.containerClass),this.$currentFilter=this.$container.find(this.oSettings.currentFilterCssClass),this.$items=this.$container.find(this.oSettings.itemCssClass),this.$processing=a(this.oSettings.progressingClass),this.$navFilter=a(this.oSettings.navFiltersCssClass),this.$appendTo=this.$container.find(this.oSettings.appendTo)},e.updateArgs={ajaxOptions:function(b,c){this.ajaxOptions=a.extend(this.ajaxOptions,c)}},e.prototype.parseNumberOfItemsLoaded=function(){var a=this.$currentFilter.data("filter");return void 0===a&&(a=this.$currentFilter.children().data("filter")),"*"!=a?this.$container.find(a).length:this.$items.length},e.prototype.toggleProcessing=function(a){this.$processing.toggleClass(a)},e.prototype.parseAjaxData=function(){this.ajaxOptions.security=this.$element.data("nonce"),this.ajaxOptions.max_posts=this.$element.data("max_posts"),this.ajaxOptions.number_of_loaded=this.parseNumberOfItemsLoaded(),this.ajaxOptions.windowWidth=a(b).width(),null===this.ajaxOptions.post__not_in&&(this.ajaxOptions.post__not_in=this.$element.data("postids"),this._post__not_in=this.ajaxOptions.post__not_in),this.ajaxOptions.term_ids=null===this.ajaxOptions.term_ids?this.$element.data("terms"):this.ajaxOptions.term_ids},e.prototype.whileAppendItems=function(b,c){var d=this.beforeAppend(b);if(a().isotope?(this.$appendTo.append(d),this.beforeAppendToIsotope(),d.imagesLoaded(function(){this.$appendTo.data("isotope")?this._isSingleTerm?(this.$appendTo.isotope("appended",d).isotope("layout"),this.$appendTo.trigger("layoutComplete"),this.$appendTo.parent().data("wiloke.masonry.triggerresizewhenall",!0)):this.$appendTo.isotope("appended",d).isotope("layout").isotope({sortBy:"original-order"}):this.handleAppendItems(d),this.afterAppendedIsotope()}.bind(this))):(this.$appendTo.append(d).masonry("appended",d),this.$appendTo.masonry("reloadItems").masonry({sortBy:"original-order"})),this.afterAppended(),this.$element.data("is-ajax",!1),"yes"==c.data.finished){if(this._isSingleTerm)return void this.$processing.fadeOut("slow",function(){a(this).remove()});this.$element.addClass("hidden")}this.$element.hasClass("mixed-loadmore-and-infinite-scroll")?(this.$element.removeClass("loaded"),this.toggleProcessing("loading")):(this.toggleProcessing("loading loaded"),this.$element.removeClass("visibility-hidden")),this.$element.prop("disabled",!1)},e.prototype.imageLoaded=function(b,c){var d=this,e=b.length;e=parseInt(e,10)-1;for(var f=0;f<=e;f++){var g=new Image;g.src=a("img",b[f]).attr("src"),f===e&&(g.onload=function(){d.whileAppendItems(b,c)},g.error=function(){d.whileAppendItems(b,c)})}},e.prototype.ajaxHandle=function(){var b=this;this._xhr&&4!==this._xhr.readyState||(this._xhr=a.ajax({method:"POST",url:WILOKE_GLOBAL.ajaxurl,cache:!0,data:b.ajaxOptions,success:function(a,c,d){b.oSettings.isInfiniteScroll&&null!=b._inView&&b._inView.destroy();var e=d.getResponseHeader("Wiloke-PostsNotIn");if(b.ajaxOptions.post__not_in=b._post__not_in+","+e,a.success){if(b._isSingleTerm&&(b.$currentFilter.data("is_loaded",!0),b.$element.data("is-ajax-"+b._term,!0),b.toggleProcessing("loaded")),b.$element.data("is-ajax",!1),""==a.data||!a.data)return b.$element.remove(),void b.toggleProcessing("loaded")}else{if(b.toggleProcessing("loading"),!b._isSingleTerm)return void b.$element.remove();b.$element.data("is-ajax-"+b._term,!0),b.$element.prop("disabled",!1)}b._currentPage=a.data.next_page,b.ajaxOptions.totalAjaxLoaded+=length,b.ajaxOptions.number_of_loaded+=a.data.data.item.length,b.imageLoaded.call(b,a.data.data.item,a)}}))},e.prototype.loadMoreEvent=function(){this.$element.on("click",a.proxy(function(b){b.preventDefault();var d=a(b.currentTarget);return d.addClass("visibility-hidden"),!d.hasClass("is_now_allow")&&(this._xhr&&4!==this._xhr.readyState||!0===d.data("is-ajax")?(this.$processing.removeClass("loading"),this.$processing.addClass("loaded"),!1):(this.$processing.addClass("loading"),this.$processing.removeClass("loaded"),this.oSettings.is_debug||(d.data("is-ajax",!0),d.prop("disabled",!0)),d.hasClass("mixed-loadmore-and-infinite-scroll")&&(this.oSettings.isInfiniteScroll=!0),void a(c.body).trigger("wiloke.infinite_scroll.ajax_running")))},this))},e.prototype.navigationEvent=function(){this.$navFilter.on("click",a.proxy(function(b){var c=a(b.currentTarget),d=c.data("filter");this.ajaxOptions.term_ids=c.data("termid"),this.ajaxOptions.totalPostsOfTerm=c.data("total"),void 0===d&&(d=c.children().data("filter")),c.data("is-loaded")?(this.$processing.removeClass("loading"),this.$element.prop("disabled",!0)):this.$element.prop("disabled",!1),this.$appendTo.find(d).length<1&&(this.$element.trigger("click"),"yes"==this.$element.data("only-one-time")&&c.data("is-loaded",!0)),"*"==d?(this._isSingleTerm=!1,this.$items.length==this.max_posts?this.$element.remove():this.$element.removeClass("hidden")):(this._isSingleTerm=!0,this.$container.find(d).length>=this.ajaxOptions.totalPostsOfTerm?this.$element.addClass("hidden"):this.$element.removeClass("hidden"))},this))},e.prototype.triggerInfiniteScroll=function(){var a=this;a._inView=new Waypoint.Inview({element:a.$element[0],enter:function(b){a.oSettings.direction_enter==b&&a.$element.trigger("click")},entered:function(a){},exit:function(b){a.$element.trigger("click")},exited:function(a){}})},e.prototype.destroy=function(){a(c.body).off("wiloke.infinite_scroll.ajax_options"),a(c.body).off("wiloke.infinite_scroll.ajax_running"),this.$element.off("click"),delete this.oSettings,delete this.ajaxOptions,delete this._post__not_in,delete this._isSingleTerm,delete this._term,delete this._currentPage,delete this._xhr,delete this._inView},e.prototype.subscribe=function(){a(c.body).on("wiloke.infinite_scroll.ajax_options",a.proxy(function(){this.updateArgs.ajaxOptions},this)),a(c.body).on("wiloke.infinite_scroll.ajax_running",a.proxy(function(){this.ajaxHandle()},this))},a.fn.WilokeInfiniteScroll=function(b){return this.each(function(){var c=a(this),d=c.data("wiloke.infinite_scroll");d||(d=new e(this,b),c.data("wiloke.infinite_scroll",d))})},a.fn.WilokeInfiniteScroll.Constructor=e,e.prototype.initialize=function(){this.setup(),this.parseAjaxData(),this.subscribe(),this.loadMoreEvent(),this.navigationEvent(),this.$element.removeData()}}(jQuery,window,document);