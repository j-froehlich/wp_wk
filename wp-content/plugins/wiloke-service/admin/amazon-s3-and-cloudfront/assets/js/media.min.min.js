var test={};(function(h,f){var g=wp.media;var e=g.view.Attachment.Details.TwoColumn;g.view.Attachment.Details.TwoColumn=e.extend({events:function(){return f.extend({},e.prototype.events,{"click .local-warning":"confirmS3Removal","click #as3cfpro-toggle-acl":"toggleACL"})},render:function(){this.fetchS3Details(this.model.get("id"))},fetchS3Details:function(a){wp.ajax.send("as3cf_get_attachment_s3_details",{data:{_nonce:as3cf_media.nonces.get_attachment_s3_details,id:a}}).done(f.bind(this.renderView,this))},renderView:function(a){e.prototype.render.apply(this);this.renderActionLinks(a);this.renderS3Details(a)},renderActionLinks:function(d){var j=(d&&d.links)||[];var a=this.$el.find(".actions");var c=h("<div />",{"class":"s3-actions"});var b=[];f(j).each(function(i){b.push(i)});c.append(b.join(" | "));a.append(c)},renderS3Details:function(c){if(!c||!c.s3object){return}var a=this.$el.find(".attachment-info .details");var b=this.generateDetails(c,["bucket","key","region","acl"]);a.append(b)},generateDetails:function(d,a){var c="";var b=f.template('<div class="<%= key %>"><strong><%= label %>:</strong> <%= value %></div>');f(a).each(function(n){if(d.s3object[n]){var m=d.s3object[n];if("acl"===n){m=d.s3object[n]["name"];if(d.acl_toggle){var l=f.template('<a href="#" id="as3cfpro-toggle-acl" title="<%= title %>" data-currentACL="<%= acl %>"><%= value %></a>');m=l({title:d.s3object[n]["title"],acl:d.s3object[n]["acl"],value:m})}}c+=b({key:n,label:as3cf_media.strings[n],value:m})}});return c},confirmS3Removal:function(a){if(!confirm(as3cfpro_media.strings.local_warning)){a.preventDefault();a.stopImmediatePropagation();return false}},toggleACL:function(a){a.preventDefault();var d=h("#as3cfpro-toggle-acl");var b=d.attr("data-currentACL");var c=as3cfpro_media.settings.private_acl;d.hide();d.after('<span id="as3cfpro-updating">'+as3cfpro_media.strings.updating_acl+"</span>");if(b===as3cfpro_media.settings.private_acl){c=as3cfpro_media.settings.default_acl}wp.ajax.send("as3cfpro_update_acl",{data:{_nonce:as3cfpro_media.nonces.update_acl,id:this.model.get("id"),acl:c}}).done(f.bind(this.updateACL,this)).fail(f.bind(this.renderACLError,this))},renderACLError:function(){h("#as3cfpro-updating").remove();h("#as3cfpro-toggle-acl").show();alert(as3cfpro_media.strings.change_acl_error)},updateACL:function(a){if("undefined"===typeof a.acl_display||"undefined"===typeof a.title||"undefined"===typeof a.acl){this.renderACLError();return}var b=h("#as3cfpro-toggle-acl");h("#as3cfpro-updating").remove();b.text(a.acl_display);b.attr("title",a.title);b.attr("data-currentACL",a.acl);b.show()}})})(jQuery,_);