/*! word-and-character-counter.js
 v2.4 (c) Wilkins Fernandez
 MIT License
 */
(function(a){a.fn.extend({counter:function(e){var f={type:"char",count:"down",goal:140,text:true,target:false,append:true,translation:"",msg:""};var d="",c="",g=false,e=a.extend({},f,e);var b={init:function(k){var h=k.attr("id"),i=h+"_count";b.isLimitless();d=a("<span id="+i+"/>");var j=a("<div/>").attr("id",h+"_counter").addClass("input-counter").append(d).append(" "+b.setMsg());if(!e.target||!a(e.target).length){e.append?j.insertAfter(k):j.insertBefore(k)}else{e.append?a(e.target).append(j):a(e.target).prepend(j)}b.bind(k)},bind:function(h){h.bind("keypress.counter keydown.counter keyup.counter blur.counter focus.counter change.counter paste.counter",b.updateCounter);h.bind("keydown.counter",b.doStopTyping);h.trigger("keydown")},isLimitless:function(){if(e.goal==="sky"){e.count="up";g=true;return g}},setMsg:function(){if(e.msg!==""){return e.msg}if(e.text===false){return""}if(g){if(e.msg!==""){return e.msg}else{return""}}this.text=e.translation||"character word left max";this.text=this.text.split(" ");this.chars="s ( )".split(" ");this.msg=null;switch(e.type){case"char":if(e.count===f.count&&e.text){this.msg=this.text[0]+this.chars[1]+this.chars[0]+this.chars[2]+" "+this.text[2]}else{if(e.count==="up"&&e.text){this.msg=this.text[0]+this.chars[0]+" "+this.chars[1]+e.goal+" "+this.text[3]+this.chars[2]}}break;case"word":if(e.count===f.count&&e.text){this.msg=this.text[1]+this.chars[1]+this.chars[0]+this.chars[2]+" "+this.text[2]}else{if(e.count==="up"&&e.text){this.msg=this.text[1]+this.chars[1]+this.chars[0]+this.chars[2]+" "+this.chars[1]+e.goal+" "+this.text[3]+this.chars[2]}}break;default:}return this.msg},getWords:function(h){if(h!==""){return a.trim(h).replace(/\s+/g," ").split(" ").length}else{return 0}},updateCounter:function(k){var j=a(this);if(c<0||c>e.goal){b.passedGoal(j)}var h=a(d).parent();if(e.type===f.type){if(e.count===f.count){c=e.goal-j.val().length;if(c<=0){d.text("0")}else{d.text(c)}}else{if(e.count==="up"){c=j.val().length;d.text(c)}}}else{if(e.type==="word"){if(e.count===f.count){c=b.getWords(j.val());if(c<=e.goal){c=e.goal-c;d.text(c)}else{d.text("0")}}else{if(e.count==="up"){c=b.getWords(j.val());d.text(c)}}}}var i=(c/e.goal);if(i==0){jQuery(h).removeClass("near-limit");jQuery(h).addClass("at-limit")}else{if(i<=0.34){jQuery(h).removeClass("at-limit");jQuery(h).addClass("near-limit")}else{jQuery(h).removeClass("near-limit");jQuery(h).removeClass("at-limit")}}return},doStopTyping:function(i){var h=[46,8,9,35,36,37,38,39,40,32];if(b.isGoalReached(i)){if(i.keyCode!==h[0]&&i.keyCode!==h[1]&&i.keyCode!==h[2]&&i.keyCode!==h[3]&&i.keyCode!==h[4]&&i.keyCode!==h[5]&&i.keyCode!==h[6]&&i.keyCode!==h[7]&&i.keyCode!==h[8]){if(e.type===f.type){return false}else{if(i.keyCode!==h[9]&&i.keyCode!==h[1]&&e.type!=f.type){return true}else{return false}}}}},isGoalReached:function(i,h){if(g){return false}if(e.count===f.count){h=0;return(c<=h)?true:false}else{h=e.goal;return(c>=h)?true:false}},wordStrip:function(i,j){var h=j.replace(/\s+/g," ").split(" ").length;j=a.trim(j);if(i<=0||i===h){return j}else{j=a.trim(j).split(" ");j.splice(i,h,"");return a.trim(j.join(" "))}},passedGoal:function(i){var h=i.val();if(e.type==="word"){i.val(b.wordStrip(e.goal,h))}if(e.type==="char"){i.val(h.substring(0,e.goal))}if(e.type==="down"){d.val("0")}if(e.type==="up"){d.val(e.goal)}}};return this.each(function(){b.init(a(this))})}})})(jQuery);