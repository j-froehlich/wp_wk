/*! word-and-character-counter.js
 v2.4 (c) Wilkins Fernandez
 MIT License
 */
(function(a){a.fn.extend({counter:function(c){var g={type:"char",count:"down",goal:140,text:true,target:false,append:true,translation:"",msg:""};var e="",b="",d=false,c=a.extend({},g,c);var f={init:function(l){var j=l.attr("id"),k=j+"_count";f.isLimitless();e=a("<span id="+k+"/>");var h=a("<div/>").attr("id",j+"_counter").addClass("input-counter").append(e).append(" "+f.setMsg());if(!c.target||!a(c.target).length){c.append?h.insertAfter(l):h.insertBefore(l)}else{c.append?a(c.target).append(h):a(c.target).prepend(h)}f.bind(l)},bind:function(h){h.bind("keypress.counter keydown.counter keyup.counter blur.counter focus.counter change.counter paste.counter",f.updateCounter);h.bind("keydown.counter",f.doStopTyping);h.trigger("keydown")},isLimitless:function(){if(c.goal==="sky"){c.count="up";d=true;return d}},setMsg:function(){if(c.msg!==""){return c.msg}if(c.text===false){return""}if(d){if(c.msg!==""){return c.msg}else{return""}}this.text=c.translation||"character word left max";this.text=this.text.split(" ");this.chars="s ( )".split(" ");this.msg=null;switch(c.type){case"char":if(c.count===g.count&&c.text){this.msg=this.text[0]+this.chars[1]+this.chars[0]+this.chars[2]+" "+this.text[2]}else{if(c.count==="up"&&c.text){this.msg=this.text[0]+this.chars[0]+" "+this.chars[1]+c.goal+" "+this.text[3]+this.chars[2]}}break;case"word":if(c.count===g.count&&c.text){this.msg=this.text[1]+this.chars[1]+this.chars[0]+this.chars[2]+" "+this.text[2]}else{if(c.count==="up"&&c.text){this.msg=this.text[1]+this.chars[1]+this.chars[0]+this.chars[2]+" "+this.chars[1]+c.goal+" "+this.text[3]+this.chars[2]}}break;default:}return this.msg},getWords:function(h){if(h!==""){return a.trim(h).replace(/\s+/g," ").split(" ").length}else{return 0}},updateCounter:function(j){var i=a(this);if(b<0||b>c.goal){f.passedGoal(i)}var h=a(e).parent();if(c.type===g.type){if(c.count===g.count){b=c.goal-i.val().length;if(b<=0){e.text("0")}else{e.text(b)}}else{if(c.count==="up"){b=i.val().length;e.text(b)}}}else{if(c.type==="word"){if(c.count===g.count){b=f.getWords(i.val());if(b<=c.goal){b=c.goal-b;e.text(b)}else{e.text("0")}}else{if(c.count==="up"){b=f.getWords(i.val());e.text(b)}}}}var k=b/c.goal;if(k==0){jQuery(h).removeClass("near-limit");jQuery(h).addClass("at-limit")}else{if(k<=0.34){jQuery(h).removeClass("at-limit");jQuery(h).addClass("near-limit")}else{jQuery(h).removeClass("near-limit");jQuery(h).removeClass("at-limit")}}return},doStopTyping:function(i){var h=[46,8,9,35,36,37,38,39,40,32];if(f.isGoalReached(i)){if(i.keyCode!==h[0]&&i.keyCode!==h[1]&&i.keyCode!==h[2]&&i.keyCode!==h[3]&&i.keyCode!==h[4]&&i.keyCode!==h[5]&&i.keyCode!==h[6]&&i.keyCode!==h[7]&&i.keyCode!==h[8]){if(c.type===g.type){return false}else{if(i.keyCode!==h[9]&&i.keyCode!==h[1]&&c.type!=g.type){return true}else{return false}}}}},isGoalReached:function(i,h){if(d){return false}if(c.count===g.count){h=0;return b<=h?true:false}else{h=c.goal;return b>=h?true:false}},wordStrip:function(h,j){var i=j.replace(/\s+/g," ").split(" ").length;j=a.trim(j);if(h<=0||h===i){return j}else{j=a.trim(j).split(" ");j.splice(h,i,"");return a.trim(j.join(" "))}},passedGoal:function(h){var i=h.val();if(c.type==="word"){h.val(f.wordStrip(c.goal,i))}if(c.type==="char"){h.val(i.substring(0,c.goal))}if(c.type==="down"){e.val("0")}if(c.type==="up"){e.val(c.goal)}}};return this.each(function(){f.init(a(this))})}})})(jQuery);