/*!
 * jQuery serializeFullArray - v0.1 - 28/06/2010
 * http://github.com/jhogendorn/jQuery-serializeFullArray/
 *
 * Copyright (c) 2010 Joshua Hogendorn
 *
 *
 * Whereas .serializeArray() serializes a form into a key:pair array, .serializeFullArray()
 * builds it into a n-tier object, respecting form input arrays.
 *
 */
(function($){$.fn.serializeFullArray=function(){var g=$(this).serializeArray();var b={};for(var f in g){if(!g.hasOwnProperty(f)){continue}var c=g[f].name.split(/\]|\[/);c=$.grep(c,function(j){return j!=""});var a=b;for(var e in c){if(!c.hasOwnProperty(e)){continue}var i=c[e];var h={};if(e==c.length-1){var h=g[f].value}var d={};d[i]=h;$.extend(true,a,d);a=a[i]}}return b}})(jQuery);jQuery.fn.tinymce_textareas=function(){tinyMCE.init({skin:"wp_theme"})};jQuery.fn.nextElementInDom=function(a,b){var e={stopAt:"body"};b=jQuery.extend(e,b);var c=jQuery(this).parent();var d=c.find(a);switch(true){case (d.length>0):return d;case (c.length===0||c.is(b.stopAt)):return jQuery([]);default:return c.nextElementInDom(a)}};jQuery(document).ready(function(a){a(".ninja-forms-admin-date").datepicker(ninja_forms_settings.datepicker_args);a(".ninja-forms-select-all").click(function(){var b=this.title;var c=this.checked;a("."+b).prop("checked",c)});a("#side-sortables").sortable({placeholder:"ui-state-highlight",helper:"clone",handle:".hndl",stop:function(g,f){var b=a("#side-sortables").sortable("toArray");var d=a("#_page").val();var c=a("#_tab").val();a.post(ajaxurl,{order:b,page:d,tab:c,action:"ninja_forms_side_sortable",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(e){})}});a(document).on("keydown","form input",function(c){if(c.keyCode==13){var b=a(this).attr("type");if(b!="textarea"){return false}}});a(document).on("click",".metabox-item-edit",function(b){b.preventDefault();a(this).parent().parent().find(".inside").slideToggle("fast")});a(".hndle").dblclick(function(b){a(this).prevAll(".item-controls:first").find("a").click()});a(document).on("keyup",".ninja-forms-field-label",function(){var c=this.id.replace("ninja_forms_field_","");c=c.replace("_label","");var b=this.value;b=ninja_forms_escape_html(b);if(a.trim(b)==""){b=a(this).parent().parent().parent().prev().find(".item-type:first").prop("innerHTML")}a("#ninja_forms_field_"+c+"_title").prop("innerHTML",b);if(b.length>15){b=b.substring(0,15);b+="..."}a(".ninja-forms-field-conditional-cr-field option[value='"+c+"']").each(function(){a(this).text(c+" - "+b)});a(".ninja-forms-calc-select option[value='"+c+"']").each(function(){a(this).text(c+" - "+b)})});a(document).on("change",".ninja-forms-show-help",function(c){var b=this.id.replace("ninja_forms_field_","");b=b.replace("_show_help","");if(this.checked){a("#ninja_forms_field_"+b+"_help_span").show()}else{a("#ninja_forms_field_"+b+"_help_span").hide()}});a(document).on("change",".ninja-forms-show-desc",function(c){var b=this.id.replace("ninja_forms_field_","");b=b.replace("_show_desc","");if(this.checked){a("#ninja_forms_field_"+b+"_desc_span").show()}else{a("#ninja_forms_field_"+b+"_desc_span").hide()}});a(".ninja-forms-delete-form").click(function(c){c.preventDefault();var b=this.id.replace("ninja_forms_delete_form_","");var d=confirm("Really delete this form? (Irreversible)");if(d){a.post(ajaxurl,{form_id:b,action:"ninja_forms_delete_form",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(e){a("#ninja_forms_form_"+b+"_tr").css("background-color","#FF0000").fadeOut("slow",function(){a(this).remove()})})}});a(".ninja-forms-delete-sub").click(function(c){c.preventDefault();var b=this.id.replace("ninja_forms_sub_","");var d=confirm("Permenantly delete this item?");if(d){a.post(ajaxurl,{sub_id:b,action:"ninja_forms_delete_sub",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(e){a("#ninja_forms_sub_"+b+"_tr").css("background-color","#FF0000").fadeOut("slow",function(){a(this).remove()})})}});a(document).on("change",".ninja-forms-_text-default-value",function(){var b=this.id.replace("default_value_","");if(this.value=="_custom"||this.value=="querystring"){a("#ninja_forms_field_"+b+"_default_value").val("");a("#default_value_label_"+b).show();a("#ninja_forms_field_"+b+"_default_value").focus()}else{a(".querystring-error").hide();a("#ninja_forms_field_"+b+"_default_value").removeClass("error");a("#default_value_label_"+b).hide();a("#ninja_forms_field_"+b+"_default_value").val(this.value)}if("querystring"!=this.value){a(".querystring-error").hide();a("#ninja_forms_field_"+b+"_default_value").removeClass("error");a(".nf-save-admin-fields").attr("disabled",false)}if(this.value!=""&&this.value!="today"){a("#ninja_forms_field_"+b+"_datepicker").prop("checked",false)}});a(document).on("keyup",".nf-default-value-text",function(){var b=a(this).data("field-id");if(-1!=wp_reserved_terms.indexOf(this.value)&&"querystring"==a("#default_value_"+b).val()){a(".querystring-error").show();a(this).addClass("error");a(".nf-save-admin-fields").attr("disabled",true)}else{a(".querystring-error").hide();a(this).removeClass("error");a(".nf-save-admin-fields").attr("disabled",false)}});a(document).on("change",".ninja-forms-_text-mask",function(){var b=this.id.replace("mask_","");if(this.value=="_custom"){a("#ninja_forms_field_"+b+"_mask").val("");a("#mask_label_"+b).show();a("#ninja_forms_field_"+b+"_mask").focus()}else{a("#mask_label_"+b).hide();a("#ninja_forms_field_"+b+"_mask").val(this.value)}if(this.value!=""){a("#ninja_forms_field_"+b+"_datepicker").prop("checked",false)}});a(document).on("click",".ninja-forms-mask-help",function(b){b.preventDefault();if(!a("#tab-panel-mask_help").is(":visible")){a("#tab-link-mask_help").find("a").click();a("#contextual-help-link").click().focus()}});a(document).on("change",".ninja-forms-_text-datepicker",function(){var b=this.id.replace("ninja_forms_field_","");b=b.replace("_datepicker","");if(this.checked==true){if(a("#ninja_forms_field_"+b+"_mask").val()!="today"){a("#ninja_forms_field_"+b+"_mask").val("")}a("#default_value_"+b).val("");a("#default_value_label_"+b).hide();a("#mask_"+b).val("");a("#mask_label_"+b).hide()}});a(document).on("click",".ninja-forms-field-collapse-options",function(c){c.preventDefault();var b=this.id.replace("ninja_forms_field_","");b=b.replace("_collapse_options","");a("#ninja_forms_field_"+b+"_list_span").slideToggle(function(){})});a(document).on("change",".ninja-forms-_list-list_type",function(){var b=this.id.replace("ninja_forms_field_","");b=b.replace("_list_type","");if(this.value=="multi"){a("#ninja_forms_field_"+b+"_multi_size_p").show()}else{a("#ninja_forms_field_"+b+"_multi_size_p").hide()}if(this.value=="radio"||this.value=="checkbox"){a("#ninja_forms_field_"+b+"_label_pos").val("left");a("#ninja_forms_field_"+b+"_label_pos option[value='inside']").attr("disabled",true)}else{a("#ninja_forms_field_"+b+"_label_pos option[value='inside']").attr("disabled",false)}});a(".ninja-forms-field-list-options").sortable({helper:"clone",handle:".ninja-forms-drag",items:"div",placeholder:"ui-state-highlight"});a(document).on("change",".ninja-forms-field-list-show-value",function(c){var b=this.id.replace("ninja_forms_field_","");b=b.replace("_list_show_value","");if(this.checked){a(".ninja-forms-field-"+b+"-list-option-value").show()}else{a(".ninja-forms-field-"+b+"-list-option-value").hide()}});a(document).on("click",".ninja-forms-field-add-list-option",function(d){d.preventDefault();var c=this.id.replace("ninja_forms_field_","");c=c.replace("_list_add_option","");var b=a(".ninja-forms-field-"+c+"-list-option").length;var e=a("#ninja_forms_field_"+c+"_list_show_value").prop("checked");if(e){e=1}else{e=0}a.post(ajaxurl,{field_id:c,x:b,hidden_value:e,action:"ninja_forms_add_list_option",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(f){a("#ninja_forms_field_"+c+"_list_options").append(f);a("#ninja_forms_field_"+c+"_list_option_"+b).fadeIn();a(".ninja-forms-field-conditional-value-list").each(function(){a(this).append("<option value='' title='"+b+"'></option>")});a("[name='ninja_forms_field_"+c+"\\[list\\]\\[options\\]\\["+b+"\\]\\[label\\]']").focus()})});a(document).on("click",".nf-remove-list-option",function(d){d.preventDefault();var c=this.id.replace("ninja_forms_field_","");c=c.replace("_list_remove_option","");var b=a(this).parent().prop("id");b=b.replace("ninja_forms_field_"+c+"_list_option_","");a(this).parent().parent().parent().parent().parent().fadeOut(300,function(){a(this).remove()});a(".ninja-forms-field-conditional-value-list").each(function(){a(this).children("option").each(function(){if(this.title==b){a(this).remove()}})})});a(document).on("keydown",".ninja-forms-field-list-option-label",function(c){if(c.keyCode==13){var b=this.id.replace("option_label","add_option");a("#"+b).click();return false}});a(document).on("keydown",".ninja-forms-field-list-option-value",function(c){if(c.keyCode==13){var b=this.id.replace("option_value","add_option");a("#"+b).click();return false}});a(document).on("keydown",".ninja-forms-field-list-option-calc",function(c){if(c.keyCode==13){var b=this.id.replace("option_calc","add_option");a("#"+b).click();return false}});a(document).on("keyup",".ninja-forms-field-list-option-label",function(){var d=this.id.replace("ninja_forms_field_","");d=d.replace("_list_option_label","");var c=this.value;var b=a(this).parent().prop("id").replace("ninja_forms_field_"+d+"_list_option_","");var e=a("#ninja_forms_field_"+d+"_list_show_value").prop("checked");a(".ninja-forms-field-conditional-cr-field").each(function(){if(this.value==d){a(this).nextElementInDom(".ninja-forms-field-conditional-cr-value-list").each(function(){a(this).children("option").each(function(){if(this.title==b){this.text=c;if(!e){this.value=c}}})})}});a(".ninja-forms-field-"+d+"-conditional-value").children("option").each(function(){if(this.title==b){this.text=c;if(!e){this.value=c}}})});a(document).on("keyup",".ninja-forms-field-list-option-value",function(){var c=this.id.replace("ninja_forms_field_","");c=c.replace("_list_option_value","");var d=this.value;var b=a(this).parent().parent().prop("id").replace("ninja_forms_field_"+c+"_list_option_","");a(".ninja-forms-field-conditional-cr-field").each(function(){if(this.value==c){a(this).nextElementInDom(".ninja-forms-field-conditional-cr-value-list").each(function(){a(this).children("option").each(function(){if(this.title==b){this.value=d}})})}});a(".ninja-forms-field-"+c+"-conditional-value").children("option").each(function(){if(this.title==b){this.value=d}})});a(document).on("change",".ninja-forms-hidden-default-value",function(){var b=a(this).attr("rel");if(this.value=="custom"){a("#ninja_forms_field_"+b+"_default_value").val("");a("#default_value_label_"+b).show();a("#ninja_forms_field_"+b+"_default_value").focus()}else{a("#ninja_forms_field_"+b+"_default_value").val(this.value);a("#default_value_label_"+b).hide()}});a(".cancel-list-import").click(function(b){b.preventDefault();tb_remove()});a(document).on("click",".save-list-import",function(d){d.preventDefault();var b=a(this).parent().find("textarea").val();var c=a(this).attr("rel");a.post(ajaxurl,{options:b,field_id:c,action:"ninja_forms_import_list_options",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(e){a("#ninja_forms_field_"+c+"_list_options").append(e);tb_remove()})});a(document).on("change",".ninja-forms-list-populate-term",function(d,c){var b=a(this).attr("rel");if(this.value!=""){a.post(ajaxurl,{field_id:b,tax_name:this.value,from_ajax:1,action:"ninja_forms_list_terms_checkboxes",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(e){a("#ninja_forms_field_"+b+"_exclude_terms").html(e);a("#ninja_forms_field_"+b+"_exclude_terms").show()})}else{a("#ninja_forms_field_"+b+"_exclude_terms").hide()}});a(document).on("change",".ninja-forms-_profile_pass-reg_password",function(){if(this.checked){a(".reg-password").parent().parent().show()}else{a(".reg-password").parent().parent().hide()}});a(document).on("click",".ninja-forms-field-add-calc",function(d){d.preventDefault();var c=a(this).attr("rel");var f=a(this).next(".spinner");a(f).show();var b=a("#ninja_forms_field_"+c+"_calc").find(".ninja-forms-calc-row:last").attr("rel");if(isNaN(b)){b=0}else{b=parseInt(b);b=b+1}a.post(ajaxurl,{field_id:c,x:b,action:"ninja_forms_add_calc_row",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(e){a("#ninja_forms_field_"+c+"_calc").append(e);a(f).hide()})});a(document).on("click",".ninja-forms-field-remove-calc",function(d){d.preventDefault();var c=a(this).attr("rel");var b=a(this).attr("name");a("#ninja_forms_field_"+c+"_calc_row_"+b).hide(function(){a("#ninja_forms_field_"+c+"_calc_row_"+b).remove()})});a(document).on("keyup",".ninja-forms-calc-name",function(){var c=a(this).prop("id");c=c.replace("ninja_forms_field_","");c=c.replace("_calc_name","");var b=this.value;b=ninja_forms_escape_html(b);if(a.trim(b)==""){b="calc_name"}a(this).parent().parent().parent().prev().find(".ninja-forms-field-title").html(b)});a(document).bind("addField",function(c,b){a(".ninja-forms-calc-select").each(function(){a(this).append('<option value="'+b.new_id+'">'+b.new_id+" - "+b.new_type+"</option>")})});a(document).bind("removeField",function(c,b){a(".ninja-forms-calc-select option[value='"+b+"']").remove()});a(document).on("change",".ninja-forms-calc-display",function(c){var b=this.id.replace("ninja_forms_field_","");b=b.replace("_calc_display_type","");if(this.value=="html"){a("#ninja_forms_field_"+b+"_calc_text_display").hide();a("#ninja_forms_field_"+b+"_calc_html_display").show();a("#ninja_forms_field_"+b+"_calc_extra_display").show();a("#ninja_forms_field_"+b+"_label").val("")}else{if(this.value=="text"){a("#ninja_forms_field_"+b+"_calc_text_display").show();a("#ninja_forms_field_"+b+"_calc_html_display").hide();a("#ninja_forms_field_"+b+"_calc_extra_display").show()}else{a("#ninja_forms_field_"+b+"_calc_text_display").hide();a("#ninja_forms_field_"+b+"_calc_html_display").hide();a("#ninja_forms_field_"+b+"_calc_extra_display").hide();a("#ninja_forms_field_"+b+"_label").val("")}}});a(document).on("change",".ninja-forms-calc-method",function(b){if(this.value=="auto"){a(this).parent().parent().parent().find(".ninja-forms-calculations").hide();a(this).parent().parent().parent().find(".ninja-forms-eq").hide()}else{if(this.value=="fields"){a(this).parent().parent().parent().find(".ninja-forms-calculations").show();a(this).parent().parent().parent().find(".ninja-forms-eq").hide()}else{a(this).parent().parent().parent().find(".ninja-forms-calculations").hide();a(this).parent().parent().parent().find(".ninja-forms-eq").show()}}});a(document).on("change",".user-info-group-name",function(b){if(this.value=="custom"){a(this).parent().parent().next().find(".user-info-custom-group").show();a(this).parent().parent().next().find("label").show()}else{a(this).parent().parent().next().find("label").hide();a(this).parent().parent().next().find(".user-info-custom-group").hide()}});a(document).on("click",".ninja-forms-field-add-fav",function(d){d.preventDefault();var c=this.id.replace("ninja_forms_field_","");c=c.replace("_fav","");var g=new Object();var f=this.id;a("[name*='ninja_forms_field_"+c+"']").each(function(){tmp=this.name.replace("ninja_forms_field_"+c+"[","");tmp=tmp.replace("]","");if(this.type=="checkbox"){if(this.checked){g['"'+tmp+'"']=this.value}}else{g['"'+tmp+'"']=this.value}});var b=prompt(ninja_forms_settings.add_fav_prompt,"");if(b.length>=1){a.post(ajaxurl,{fav_name:b,field_data:g,field_id:c,action:"ninja_forms_add_fav",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(h){a("#ninja_forms_field_"+c+"_fav").removeClass("ninja-forms-field-add-fav");a("#ninja_forms_field_"+c+"_fav").addClass("ninja-forms-field-remove-fav");a("#ninja_forms_sidebar_fav_fields").append(h.link_html);a("#ninja_forms_field_"+c+"_title").nextElementInDom(".item-type-name:first").prop("innerHTML",h.fav_name);a("#ninja_forms_field_"+c+"_fav_id").val(h.fav_id)})}else{var e=confirm(ninja_forms_settings.add_fav_error);if(e){a("#"+f).click()}}});a(document).on("click",".ninja-forms-field-remove-fav",function(c){c.preventDefault();var b=this.id.replace("ninja_forms_field_","");b=b.replace("_fav","");a.post(ajaxurl,{field_id:b,action:"ninja_forms_remove_fav",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(d){a("#ninja_forms_insert_fav_field_"+d.fav_id+"_p").remove();a(".ninja-forms-field-fav-id").each(function(){if(this.value==d.fav_id){var e=this.id.replace("ninja_forms_field_","");e=e.replace("_fav_id","");a("#ninja_forms_field_"+e+"_fav").removeClass("ninja-forms-field-remove-fav");a("#ninja_forms_field_"+e+"_fav").addClass("ninja-forms-field-add-fav");a("#ninja_forms_field_"+e+"_title").nextElementInDom(".item-type-name:first").prop("innerHTML",d.type_name)}})})});a(document).on("click",".ninja-forms-field-add-def",function(d){d.preventDefault();var b=this.id.replace("ninja_forms_field_","");b=b.replace("_def","");var g=new Object();var f=this.id;a("[name*='ninja_forms_field_"+b+"']").each(function(){tmp=this.name.replace("ninja_forms_field_"+b+"[","");tmp=tmp.replace("]","");if(this.type=="checkbox"){if(this.checked){g['"'+tmp+'"']=this.value}}else{g['"'+tmp+'"']=this.value}});var c=prompt("What would you like to name this Defined Field?","");if(c.length>=1){a.post(ajaxurl,{def_name:c,field_data:g,field_id:b,action:"ninja_forms_add_def",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(h){a("#ninja_forms_sidebar_def_fields").append(h.link_html);a("#ninja_forms_field_"+b+"_title").nextElementInDom(".item-type:first").prop("innerHTML",h.def_name);a("#ninja_forms_field_"+b+"_def_id").val(h.def_id)})}else{var e=confirm("You must supply a name for this Defined Field.");if(e){a("#"+f).click()}}});a(document).on("click",".ninja-forms-field-remove-def",function(c){c.preventDefault();var b=this.id.replace("ninja_forms_field_","");b=b.replace("_def","");a.post(ajaxurl,{field_id:b,action:"ninja_forms_remove_def",nf_ajax_nonce:ninja_forms_settings.nf_ajax_nonce},function(d){a("#ninja_forms_insert_def_field_"+d.def_id+"_p").remove()})});a(document).on("click","#nf_deactivate_all_licenses",function(c){var b=confirm(ninja_forms_settings.deactivate_all_licenses_confirm);if(!b){return false}});a(".nf-delete-on-uninstall-prompt").nfAdminModal({title:nf_nuke_title,buttons:".nf-delete-on-uninstall-prompt-buttons"});a(document).on("click","#delete_on_uninstall",function(b){if(this.checked){this.checked=false;a(".nf-delete-on-uninstall-prompt").nfAdminModal("open")}});a(document).on("click",".nf-delete-on-uninstall-yes",function(b){b.preventDefault();a("#delete_on_uninstall").attr("checked",true);a(".nf-delete-on-uninstall-prompt").nfAdminModal("close")});a("#nf-conversion-reset").nfAdminModal({title:nf_conversion_title,buttons:"#nf-conversion-reset-buttons"});a(document).on("click",".nf-reset-form-conversion",function(b){b.preventDefault();a("#nf-conversion-reset").nfAdminModal("open")})});function ninja_forms_escape_html(a){var b=document.createElement("textarea");b.innerHTML=a;return b.innerHTML};